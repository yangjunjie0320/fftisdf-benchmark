OMP_NUM_THREADS = 64
MKL_NUM_THREADS = 1
PYSCF_MAX_MEMORY = 491520
TMPDIR = /central/scratch/yangjunjie//diamond/46996082/
PYSCF_TMPDIR = /central/scratch/yangjunjie//diamond/46996082/

/home/junjiey/anaconda3/envs/fftisdf/bin/python
2.7.0
1.14.1
1.26.4
LOADING ISDF BACKEND
NUM_THREADS   : 64
USE_NUMPY     : 0
USE_SCIPY     : 0
USE_TORCH     : 1
USE_TORCH_GPU : 0
arg.atm = [[ 4 20  1 23  0  0]
 [ 4 24  1 27  0  0]
 [ 4 28  1 31  0  0]
 [ 4 32  1 35  0  0]
 [ 4 36  1 39  0  0]
 [ 4 40  1 43  0  0]
 [ 4 44  1 47  0  0]
 [ 4 48  1 51  0  0]]
arg.bas = [[ 0  0  4  2  0 52 56  0]
 [ 0  1  4  2  0 64 68  0]
 [ 0  2  1  1  0 76 77  0]
 [ 1  0  4  2  0 52 56  0]
 [ 1  1  4  2  0 64 68  0]
 [ 1  2  1  1  0 76 77  0]
 [ 2  0  4  2  0 52 56  0]
 [ 2  1  4  2  0 64 68  0]
 [ 2  2  1  1  0 76 77  0]
 [ 3  0  4  2  0 52 56  0]
 [ 3  1  4  2  0 64 68  0]
 [ 3  2  1  1  0 76 77  0]
 [ 4  0  4  2  0 52 56  0]
 [ 4  1  4  2  0 64 68  0]
 [ 4  2  1  1  0 76 77  0]
 [ 5  0  4  2  0 52 56  0]
 [ 5  1  4  2  0 64 68  0]
 [ 5  2  1  1  0 76 77  0]
 [ 6  0  4  2  0 52 56  0]
 [ 6  1  4  2  0 64 68  0]
 [ 6  2  1  1  0 76 77  0]
 [ 7  0  4  2  0 52 56  0]
 [ 7  1  4  2  0 64 68  0]
 [ 7  2  1  1  0 76 77  0]]
arg.env = [ 0.          0.          0.          0.          0.          0.
  0.          0.          0.          0.          0.          0.
  0.          0.          0.          0.          0.          0.
  0.          0.          0.          0.          0.          0.
  1.68833329  1.68833329  1.68833329  0.          3.37666657  3.37666657
  0.          0.          5.06499986  5.06499986  1.68833329  0.
  3.37666657  0.          3.37666657  0.          5.06499986  1.68833329
  5.06499986  0.          0.          3.37666657  3.37666657  0.
  1.68833329  5.06499986  5.06499986  0.          4.33623764  1.28818385
  0.40377671  0.11878777  1.13179715 -0.08939889 -0.8807207  -0.20266289
  0.          0.          0.          0.51120349  4.33623764  1.28818385
  0.40377671  0.11878777 -1.60299215 -1.11123874 -0.44247981 -0.08255916
  0.          0.          0.          0.20344594  0.55        0.91656674]
ecpbas  = []
#INFO: **** input file is /central/home/junjiey/work/fftisdf-benchmark/test/diamond-test-build-2/main.py ****
# backend to test #

import pyscf.isdf.BackEnd._config as config

config.disable_fftw()
# config.backend("numpy")
# config.backend("scipy")
config.backend("torch")
# config.backend("torch_gpu")
import pyscf.isdf.BackEnd.isdf_backend as BACKEND

# sys and pyscf #

import numpy as np
from pyscf import lib

from pyscf.lib.parameters import BOHR
from pyscf.pbc import df

# isdf util #

from pyscf.isdf.isdf_tools_Tsym import _kmesh_to_Kpoints, _1e_operator_gamma2k
from pyscf.isdf import isdf_tools_cell
from pyscf.isdf.isdf import ISDF
from pyscf.isdf.isdf_local import ISDF_Local

#############################

ke_cutoff = 70
basis = "gth-dzvp"

boxlen = 3.57371000
prim_a = np.array([[boxlen, 0.0, 0.0], [0.0, boxlen, 0.0], [0.0, 0.0, boxlen]])
atm = [
    ["C", (0.0, 0.0, 0.0)],
    ["C", (0.8934275, 0.8934275, 0.8934275)],
    ["C", (1.786855, 1.786855, 0.0)],
    ["C", (2.6802825, 2.6802825, 0.8934275)],
    ["C", (1.786855, 0.0, 1.786855)],
    ["C", (2.6802825, 0.8934275, 2.6802825)],
    ["C", (0.0, 1.786855, 1.786855)],
    ["C", (0.8934275, 2.6802825, 2.6802825)],
]

kmeshes = [
    [1, 1, 1],
    [1, 1, 2],
    [1, 1, 3],
    [1, 1, 4],
    [1, 2, 2],
    [2, 2, 2],
    [2, 2, 3],
    [2, 3, 3],
    [3, 3, 3],
]  # -44.20339674 and -88.67568935
VERBOSE = 10

prim_cell = isdf_tools_cell.build_supercell(
    atm,
    prim_a,
    Ls=[1, 1, 1],
    ke_cutoff=ke_cutoff,
    basis=basis,
    pseudo="gth-pade",
    verbose=VERBOSE,
)

prim_group = [[0, 1], [2, 3], [4, 5], [6, 7]]

prim_mesh = prim_cell.mesh

for kmesh in kmeshes:

    mesh = [int(k * x) for k, x in zip(kmesh, prim_mesh)]
    print("kmesh:", kmesh, "mesh:", mesh)

    kpts = prim_cell.make_kpts(kmesh)

    cell, group = isdf_tools_cell.build_supercell_with_partition(
        atm,
        prim_a,
        Ls=kmesh,
        ke_cutoff=ke_cutoff,
        partition=prim_group,
        mesh=mesh,
        basis=basis,
        pseudo="gth-pade",
        verbose=VERBOSE,
    )
    cell.max_memory = 200
    print("group:", group)

    isdf = ISDF_Local(
        cell, with_robust_fitting=True, limited_memory=True, build_V_K_bunchsize=56
    )
    isdf.build(c=30, m=5, rela_cutoff=1e-4, group=group)
    # isdf.force_translation_symmetry(kmesh)

    from pyscf.pbc import scf

    mf = scf.RHF(cell)
    mf.with_df = isdf
    mf.kernel()
#INFO: ******************** input file end ********************


System: uname_result(system='Linux', node='hpc-35-03.cm.cluster', release='5.14.0-362.24.1.el9_3.x86_64', version='#1 SMP PREEMPT_DYNAMIC Thu Feb 15 07:18:13 EST 2024', machine='x86_64')  Threads 1
Python 3.12.3 | packaged by conda-forge | (main, Apr 15 2024, 18:38:13) [GCC 12.3.0]
numpy 1.26.4  scipy 1.14.1  h5py 3.12.1
Date: Mon Jan 27 14:30:41 2025
PySCF version 2.7.0
PySCF path  /home/junjiey/anaconda3/envs/fftisdf/lib/python3.12/site-packages/pyscf

[ENV] PYSCF_TMPDIR /central/scratch/yangjunjie//diamond/46996082/
[ENV] PYSCF_MAX_MEMORY 491520
[ENV] PYSCF_EXT_PATH /home/junjiey/packages/pyscf-forge/pyscf-forge-yangjunjie-non-orth/
[CONFIG] ARGPARSE = False
[CONFIG] DEBUG = False
[CONFIG] MAX_MEMORY = 491520
[CONFIG] TMPDIR = /central/scratch/yangjunjie//diamond/46996082/
[CONFIG] UNIT = angstrom
[CONFIG] VERBOSE = 3
[CONFIG] conf_file = None
[INPUT] verbose = 10
[INPUT] max_memory = 2000 
[INPUT] num. atoms = 8
[INPUT] num. electrons = 32
[INPUT] charge = 0
[INPUT] spin (= nelec alpha-beta = 2S) = 0
[INPUT] symmetry False subgroup None
[INPUT] Mole.unit = angstorm
[INPUT] Symbol           X                Y                Z      unit          X                Y                Z       unit  Magmom
[INPUT]  1 C      0.000000000000   0.000000000000   0.000000000000 AA    0.000000000000   0.000000000000   0.000000000000 Bohr   0.0
[INPUT]  2 C      0.893427500000   0.893427500000   0.893427500000 AA    1.688333287155   1.688333287155   1.688333287155 Bohr   0.0
[INPUT]  3 C      1.786855000000   1.786855000000   0.000000000000 AA    3.376666574310   3.376666574310   0.000000000000 Bohr   0.0
[INPUT]  4 C      2.680282500000   2.680282500000   0.893427500000 AA    5.064999861465   5.064999861465   1.688333287155 Bohr   0.0
[INPUT]  5 C      1.786855000000   0.000000000000   1.786855000000 AA    3.376666574310   0.000000000000   3.376666574310 Bohr   0.0
[INPUT]  6 C      2.680282500000   0.893427500000   2.680282500000 AA    5.064999861465   1.688333287155   5.064999861465 Bohr   0.0
[INPUT]  7 C      0.000000000000   1.786855000000   1.786855000000 AA    0.000000000000   3.376666574310   3.376666574310 Bohr   0.0
[INPUT]  8 C      0.893427500000   2.680282500000   2.680282500000 AA    1.688333287155   5.064999861465   5.064999861465 Bohr   0.0
[INPUT] ---------------- BASIS SET ---------------- 
[INPUT] l, kappa, [nprim/nctr], expnt,             c_1 c_2 ...
[INPUT] C
[INPUT] 0    0    [4    /2   ]  4.3362376436      0.1490797872    0
                                1.2881838513      -0.0292640031    0
                                0.4037767149      -0.688204051    0
                                0.1187877657      -0.3964426906    1
[INPUT] 1    0    [4    /2   ]  4.3362376436      -0.0878123619    0
                                1.2881838513      -0.27755603    0
                                0.4037767149      -0.4712295093    0
                                0.1187877657      -0.4058039291    1
[INPUT] 2    0    [1    /1   ]  0.55                 1

Ewald components = 11.6062017390159, -63.0574091279915, 0.401589778745918
nuclear repulsion = -51.0496176102297
number of shells = 24
number of NR pGTOs = 168
number of NR cGTOs = 104
basis = gth-dzvp
ecp = {}
bas 0, expnt(s) = [4.33623764 1.28818385 0.40377671 0.11878777]
bas 1, expnt(s) = [4.33623764 1.28818385 0.40377671 0.11878777]
bas 2, expnt(s) = [0.55]
bas 3, expnt(s) = [4.33623764 1.28818385 0.40377671 0.11878777]
bas 4, expnt(s) = [4.33623764 1.28818385 0.40377671 0.11878777]
bas 5, expnt(s) = [0.55]
bas 6, expnt(s) = [4.33623764 1.28818385 0.40377671 0.11878777]
bas 7, expnt(s) = [4.33623764 1.28818385 0.40377671 0.11878777]
bas 8, expnt(s) = [0.55]
bas 9, expnt(s) = [4.33623764 1.28818385 0.40377671 0.11878777]
bas 10, expnt(s) = [4.33623764 1.28818385 0.40377671 0.11878777]
bas 11, expnt(s) = [0.55]
bas 12, expnt(s) = [4.33623764 1.28818385 0.40377671 0.11878777]
bas 13, expnt(s) = [4.33623764 1.28818385 0.40377671 0.11878777]
bas 14, expnt(s) = [0.55]
bas 15, expnt(s) = [4.33623764 1.28818385 0.40377671 0.11878777]
bas 16, expnt(s) = [4.33623764 1.28818385 0.40377671 0.11878777]
bas 17, expnt(s) = [0.55]
bas 18, expnt(s) = [4.33623764 1.28818385 0.40377671 0.11878777]
bas 19, expnt(s) = [4.33623764 1.28818385 0.40377671 0.11878777]
bas 20, expnt(s) = [0.55]
bas 21, expnt(s) = [4.33623764 1.28818385 0.40377671 0.11878777]
bas 22, expnt(s) = [4.33623764 1.28818385 0.40377671 0.11878777]
bas 23, expnt(s) = [0.55]
CPU time:        10.69
lattice vectors  a1 [6.753333149, 0.000000000, 0.000000000]
                 a2 [0.000000000, 6.753333149, 0.000000000]
                 a3 [0.000000000, 0.000000000, 6.753333149]
dimension = 3
low_dim_ft_type = None
Cell volume = 308.003
rcut = 22.07448407082675 (nimgs = [4 4 4])
lattice sum = 899 cells
precision = 1e-08
pseudo = gth-pade
ke_cutoff = 70
    = [27 27 27] mesh (19683 PWs)
kmesh: [1, 1, 1] mesh: [27, 27, 27]
arg.atm = [[ 4 20  1 23  0  0]
 [ 4 24  1 27  0  0]
 [ 4 28  1 31  0  0]
 [ 4 32  1 35  0  0]
 [ 4 36  1 39  0  0]
 [ 4 40  1 43  0  0]
 [ 4 44  1 47  0  0]
 [ 4 48  1 51  0  0]]
arg.bas = [[ 0  0  4  2  0 52 56  0]
 [ 0  1  4  2  0 64 68  0]
 [ 0  2  1  1  0 76 77  0]
 [ 1  0  4  2  0 52 56  0]
 [ 1  1  4  2  0 64 68  0]
 [ 1  2  1  1  0 76 77  0]
 [ 2  0  4  2  0 52 56  0]
 [ 2  1  4  2  0 64 68  0]
 [ 2  2  1  1  0 76 77  0]
 [ 3  0  4  2  0 52 56  0]
 [ 3  1  4  2  0 64 68  0]
 [ 3  2  1  1  0 76 77  0]
 [ 4  0  4  2  0 52 56  0]
 [ 4  1  4  2  0 64 68  0]
 [ 4  2  1  1  0 76 77  0]
 [ 5  0  4  2  0 52 56  0]
 [ 5  1  4  2  0 64 68  0]
 [ 5  2  1  1  0 76 77  0]
 [ 6  0  4  2  0 52 56  0]
 [ 6  1  4  2  0 64 68  0]
 [ 6  2  1  1  0 76 77  0]
 [ 7  0  4  2  0 52 56  0]
 [ 7  1  4  2  0 64 68  0]
 [ 7  2  1  1  0 76 77  0]]
arg.env = [ 0.          0.          0.          0.          0.          0.
  0.          0.          0.          0.          0.          0.
  0.          0.          0.          0.          0.          0.
  0.          0.          0.          0.          0.          0.
  1.68833329  1.68833329  1.68833329  0.          3.37666657  3.37666657
  0.          0.          5.06499986  5.06499986  1.68833329  0.
  3.37666657  0.          3.37666657  0.          5.06499986  1.68833329
  5.06499986  0.          0.          3.37666657  3.37666657  0.
  1.68833329  5.06499986  5.06499986  0.          4.33623764  1.28818385
  0.40377671  0.11878777  1.13179715 -0.08939889 -0.8807207  -0.20266289
  0.          0.          0.          0.51120349  4.33623764  1.28818385
  0.40377671  0.11878777 -1.60299215 -1.11123874 -0.44247981 -0.08255916
  0.          0.          0.          0.20344594  0.55        0.91656674]
ecpbas  = []
#INFO: **** input file is /central/home/junjiey/work/fftisdf-benchmark/test/diamond-test-build-2/main.py ****
# backend to test #

import pyscf.isdf.BackEnd._config as config

config.disable_fftw()
# config.backend("numpy")
# config.backend("scipy")
config.backend("torch")
# config.backend("torch_gpu")
import pyscf.isdf.BackEnd.isdf_backend as BACKEND

# sys and pyscf #

import numpy as np
from pyscf import lib

from pyscf.lib.parameters import BOHR
from pyscf.pbc import df

# isdf util #

from pyscf.isdf.isdf_tools_Tsym import _kmesh_to_Kpoints, _1e_operator_gamma2k
from pyscf.isdf import isdf_tools_cell
from pyscf.isdf.isdf import ISDF
from pyscf.isdf.isdf_local import ISDF_Local

#############################

ke_cutoff = 70
basis = "gth-dzvp"

boxlen = 3.57371000
prim_a = np.array([[boxlen, 0.0, 0.0], [0.0, boxlen, 0.0], [0.0, 0.0, boxlen]])
atm = [
    ["C", (0.0, 0.0, 0.0)],
    ["C", (0.8934275, 0.8934275, 0.8934275)],
    ["C", (1.786855, 1.786855, 0.0)],
    ["C", (2.6802825, 2.6802825, 0.8934275)],
    ["C", (1.786855, 0.0, 1.786855)],
    ["C", (2.6802825, 0.8934275, 2.6802825)],
    ["C", (0.0, 1.786855, 1.786855)],
    ["C", (0.8934275, 2.6802825, 2.6802825)],
]

kmeshes = [
    [1, 1, 1],
    [1, 1, 2],
    [1, 1, 3],
    [1, 1, 4],
    [1, 2, 2],
    [2, 2, 2],
    [2, 2, 3],
    [2, 3, 3],
    [3, 3, 3],
]  # -44.20339674 and -88.67568935
VERBOSE = 10

prim_cell = isdf_tools_cell.build_supercell(
    atm,
    prim_a,
    Ls=[1, 1, 1],
    ke_cutoff=ke_cutoff,
    basis=basis,
    pseudo="gth-pade",
    verbose=VERBOSE,
)

prim_group = [[0, 1], [2, 3], [4, 5], [6, 7]]

prim_mesh = prim_cell.mesh

for kmesh in kmeshes:

    mesh = [int(k * x) for k, x in zip(kmesh, prim_mesh)]
    print("kmesh:", kmesh, "mesh:", mesh)

    kpts = prim_cell.make_kpts(kmesh)

    cell, group = isdf_tools_cell.build_supercell_with_partition(
        atm,
        prim_a,
        Ls=kmesh,
        ke_cutoff=ke_cutoff,
        partition=prim_group,
        mesh=mesh,
        basis=basis,
        pseudo="gth-pade",
        verbose=VERBOSE,
    )
    cell.max_memory = 200
    print("group:", group)

    isdf = ISDF_Local(
        cell, with_robust_fitting=True, limited_memory=True, build_V_K_bunchsize=56
    )
    isdf.build(c=30, m=5, rela_cutoff=1e-4, group=group)
    # isdf.force_translation_symmetry(kmesh)

    from pyscf.pbc import scf

    mf = scf.RHF(cell)
    mf.with_df = isdf
    mf.kernel()
#INFO: ******************** input file end ********************


System: uname_result(system='Linux', node='hpc-35-03.cm.cluster', release='5.14.0-362.24.1.el9_3.x86_64', version='#1 SMP PREEMPT_DYNAMIC Thu Feb 15 07:18:13 EST 2024', machine='x86_64')  Threads 1
Python 3.12.3 | packaged by conda-forge | (main, Apr 15 2024, 18:38:13) [GCC 12.3.0]
numpy 1.26.4  scipy 1.14.1  h5py 3.12.1
Date: Mon Jan 27 14:30:41 2025
PySCF version 2.7.0
PySCF path  /home/junjiey/anaconda3/envs/fftisdf/lib/python3.12/site-packages/pyscf

[ENV] PYSCF_TMPDIR /central/scratch/yangjunjie//diamond/46996082/
[ENV] PYSCF_MAX_MEMORY 491520
[ENV] PYSCF_EXT_PATH /home/junjiey/packages/pyscf-forge/pyscf-forge-yangjunjie-non-orth/
[CONFIG] ARGPARSE = False
[CONFIG] DEBUG = False
[CONFIG] MAX_MEMORY = 491520
[CONFIG] TMPDIR = /central/scratch/yangjunjie//diamond/46996082/
[CONFIG] UNIT = angstrom
[CONFIG] VERBOSE = 3
[CONFIG] conf_file = None
[INPUT] verbose = 10
[INPUT] max_memory = 2000 
[INPUT] num. atoms = 8
[INPUT] num. electrons = 32
[INPUT] charge = 0
[INPUT] spin (= nelec alpha-beta = 2S) = 0
[INPUT] symmetry False subgroup None
[INPUT] Mole.unit = angstorm
[INPUT] Symbol           X                Y                Z      unit          X                Y                Z       unit  Magmom
[INPUT]  1 C      0.000000000000   0.000000000000   0.000000000000 AA    0.000000000000   0.000000000000   0.000000000000 Bohr   0.0
[INPUT]  2 C      0.893427500000   0.893427500000   0.893427500000 AA    1.688333287155   1.688333287155   1.688333287155 Bohr   0.0
[INPUT]  3 C      1.786855000000   1.786855000000   0.000000000000 AA    3.376666574310   3.376666574310   0.000000000000 Bohr   0.0
[INPUT]  4 C      2.680282500000   2.680282500000   0.893427500000 AA    5.064999861465   5.064999861465   1.688333287155 Bohr   0.0
[INPUT]  5 C      1.786855000000   0.000000000000   1.786855000000 AA    3.376666574310   0.000000000000   3.376666574310 Bohr   0.0
[INPUT]  6 C      2.680282500000   0.893427500000   2.680282500000 AA    5.064999861465   1.688333287155   5.064999861465 Bohr   0.0
[INPUT]  7 C      0.000000000000   1.786855000000   1.786855000000 AA    0.000000000000   3.376666574310   3.376666574310 Bohr   0.0
[INPUT]  8 C      0.893427500000   2.680282500000   2.680282500000 AA    1.688333287155   5.064999861465   5.064999861465 Bohr   0.0
[INPUT] ---------------- BASIS SET ---------------- 
[INPUT] l, kappa, [nprim/nctr], expnt,             c_1 c_2 ...
[INPUT] C
[INPUT] 0    0    [4    /2   ]  4.3362376436      0.1490797872    0
                                1.2881838513      -0.0292640031    0
                                0.4037767149      -0.688204051    0
                                0.1187877657      -0.3964426906    1
[INPUT] 1    0    [4    /2   ]  4.3362376436      -0.0878123619    0
                                1.2881838513      -0.27755603    0
                                0.4037767149      -0.4712295093    0
                                0.1187877657      -0.4058039291    1
[INPUT] 2    0    [1    /1   ]  0.55                 1

Ewald components = 11.6062017390159, -63.0574091279915, 0.401589778745918
nuclear repulsion = -51.0496176102297
number of shells = 24
number of NR pGTOs = 168
number of NR cGTOs = 104
basis = gth-dzvp
ecp = {}
bas 0, expnt(s) = [4.33623764 1.28818385 0.40377671 0.11878777]
bas 1, expnt(s) = [4.33623764 1.28818385 0.40377671 0.11878777]
bas 2, expnt(s) = [0.55]
bas 3, expnt(s) = [4.33623764 1.28818385 0.40377671 0.11878777]
bas 4, expnt(s) = [4.33623764 1.28818385 0.40377671 0.11878777]
bas 5, expnt(s) = [0.55]
bas 6, expnt(s) = [4.33623764 1.28818385 0.40377671 0.11878777]
bas 7, expnt(s) = [4.33623764 1.28818385 0.40377671 0.11878777]
bas 8, expnt(s) = [0.55]
bas 9, expnt(s) = [4.33623764 1.28818385 0.40377671 0.11878777]
bas 10, expnt(s) = [4.33623764 1.28818385 0.40377671 0.11878777]
bas 11, expnt(s) = [0.55]
bas 12, expnt(s) = [4.33623764 1.28818385 0.40377671 0.11878777]
bas 13, expnt(s) = [4.33623764 1.28818385 0.40377671 0.11878777]
bas 14, expnt(s) = [0.55]
bas 15, expnt(s) = [4.33623764 1.28818385 0.40377671 0.11878777]
bas 16, expnt(s) = [4.33623764 1.28818385 0.40377671 0.11878777]
bas 17, expnt(s) = [0.55]
bas 18, expnt(s) = [4.33623764 1.28818385 0.40377671 0.11878777]
bas 19, expnt(s) = [4.33623764 1.28818385 0.40377671 0.11878777]
bas 20, expnt(s) = [0.55]
bas 21, expnt(s) = [4.33623764 1.28818385 0.40377671 0.11878777]
bas 22, expnt(s) = [4.33623764 1.28818385 0.40377671 0.11878777]
bas 23, expnt(s) = [0.55]
CPU time:        10.72
lattice vectors  a1 [6.753333149, 0.000000000, 0.000000000]
                 a2 [0.000000000, 6.753333149, 0.000000000]
                 a3 [0.000000000, 0.000000000, 6.753333149]
dimension = 3
low_dim_ft_type = None
Cell volume = 308.003
rcut = 22.07448407082675 (nimgs = [4 4 4])
lattice sum = 899 cells
precision = 1e-08
pseudo = gth-pade
mesh = [27, 27, 27] (19683 PWs)
    = ke_cutoff [73.14423411 73.14423411 73.14423411]
group: [[0, 1], [2, 3], [4, 5], [6, 7]]
ISDF: mol.ke_cutoff = 70.000000
ISDF: mol.natm      = 8
ISDF: mol.nao       = 104
************* get_partition *************
************* end get_partition *************
       get_partition wall time:     0.109239 CPU time:     0.103977
len of partition[   0] =   2677
len of partition[   1] =   2267
len of partition[   2] =   2692
len of partition[   3] =   2268
len of partition[   4] =   2659
len of partition[   5] =   2252
len of partition[   6] =   2633
len of partition[   7] =   2235
************* get_aoR *************
************* end get_aoR *************
             get_aoR wall time:     1.945815 CPU time:     1.933606
In _build_buffer: ISDF Local size of buffer = 64.151 MB
 ---------- In pyscf.isdf.isdf_local.select_IP_local_atm ----------
select_IP_local_atm: atm_begin =    0, atm_end =    8
select_IP_local_atm: npt_found =  567
select_IP_local_atm: npt_found =  531
select_IP_local_atm: npt_found =  563
select_IP_local_atm: npt_found =  533
select_IP_local_atm: npt_found =  563
select_IP_local_atm: npt_found =  528
select_IP_local_atm: npt_found =  558
select_IP_local_atm: npt_found =  532
select_IP_local_step1 wall time:     1.419544 CPU time:    89.047844
 build_aoRg_possible wall time:     0.004576 CPU time:     0.255594
select_IP_local_group: nao_group =   26
select_IP_local_group: naux_now  =   32
select_IP_local_group: max_rank  = 1024
select_IP_local_group: npt_found =  859
select_IP_local_group: nao_group =   26
select_IP_local_group: naux_now  =   32
select_IP_local_group: max_rank  = 1024
select_IP_local_group: npt_found =  884
select_IP_local_group: nao_group =   26
select_IP_local_group: naux_now  =   32
select_IP_local_group: max_rank  = 1024
select_IP_local_group: npt_found =  865
select_IP_local_group: nao_group =   26
select_IP_local_group: naux_now  =   32
select_IP_local_group: max_rank  = 1024
select_IP_local_group: npt_found =  876
select_IP_local_step2 wall time:     0.406737 CPU time:    25.966911
select_IP_local_step3 wall time:     0.025646 CPU time:     1.658794
Memory usage for aoR  :     15.624 MB
Memory usage for aoRg :      2.771 MB
            build_IP wall time:     1.856505 CPU time:   116.929142
build_aux_basis_local wall time:     0.185482 CPU time:    11.864492
 ---------- In pyscf.isdf.isdf_local.build_V_W_local ----------
Memory usage for V:    523.190 MB
Memory usage for W:     92.608 MB
     build_V_W_local wall time:     2.495322 CPU time:    82.886351


******** <class 'pyscf.pbc.scf.hf.RHF'> ********
method = RHF
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
diis_damp = 0
SCF conv_tol = 1e-07
SCF conv_tol_grad = None
SCF max_cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /central/scratch/yangjunjie/diamond/46996082/tmpev5nvzh7
max_memory 200 MB (current use 1245 MB)
******** PBC SCF flags ********
kpt = [0. 0. 0.]
Exchange divergence treatment (exxdiv) = ewald
Ewald components = 0.000105727067579829, -0.251544692466148, 0.0413725125048105
    madelung (= occupied orbital energy shift) = 0.42013290578751533
    Total energy shift due to Ewald probe charge = -1/2 * Nelec*madelung = -6.7221264926
DF object = <pyscf.isdf.isdf_local.ISDF_Local object at 0x7f9d7236bcb0>
Set gradient conv threshold to 0.000316228
Initial guess from minao.
Big error detected in the electron number of initial guess density matrix (Ne/cell = 31.7367)!
  This can cause huge error in Fock matrix and lead to instability in SCF for low-dimensional systems.
  DM is normalized wrt the number of electrons 32
arg.atm = [[ 4 20  1 23  0  0]
 [ 4 24  1 27  0  0]
 [ 4 28  1 31  0  0]
 [ 4 32  1 35  0  0]
 [ 4 36  1 39  0  0]
 [ 4 40  1 43  0  0]
 [ 4 44  1 47  0  0]
 [ 4 48  1 51  0  0]]
arg.bas = [[ 0  0  4  2  0 52 56  0]
 [ 0  1  4  2  0 64 68  0]
 [ 0  2  1  1  0 76 77  0]
 [ 1  0  4  2  0 52 56  0]
 [ 1  1  4  2  0 64 68  0]
 [ 1  2  1  1  0 76 77  0]
 [ 2  0  4  2  0 52 56  0]
 [ 2  1  4  2  0 64 68  0]
 [ 2  2  1  1  0 76 77  0]
 [ 3  0  4  2  0 52 56  0]
 [ 3  1  4  2  0 64 68  0]
 [ 3  2  1  1  0 76 77  0]
 [ 4  0  4  2  0 52 56  0]
 [ 4  1  4  2  0 64 68  0]
 [ 4  2  1  1  0 76 77  0]
 [ 5  0  4  2  0 52 56  0]
 [ 5  1  4  2  0 64 68  0]
 [ 5  2  1  1  0 76 77  0]
 [ 6  0  4  2  0 52 56  0]
 [ 6  1  4  2  0 64 68  0]
 [ 6  2  1  1  0 76 77  0]
 [ 7  0  4  2  0 52 56  0]
 [ 7  1  4  2  0 64 68  0]
 [ 7  2  1  1  0 76 77  0]]
arg.env = [ 0.          0.          0.          0.          0.          0.
  0.          0.          0.          0.          0.          0.
  0.          0.          0.          0.          0.          0.
  0.          0.          0.          0.          0.          0.
  1.68833329  1.68833329  1.68833329  0.          3.37666657  3.37666657
  0.          0.          5.06499986  5.06499986  1.68833329  0.
  3.37666657  0.          3.37666657  0.          5.06499986  1.68833329
  5.06499986  0.          0.          3.37666657  3.37666657  0.
  1.68833329  5.06499986  5.06499986  0.          4.33623764  1.28818385
  0.40377671  0.11878777  1.13179715 -0.08939889 -0.8807207  -0.20266289
  0.          0.          0.          0.51120349  4.33623764  1.28818385
  0.40377671  0.11878777 -1.60299215 -1.11123874 -0.44247981 -0.08255916
  0.          0.          0.          0.20344594  0.55        0.91656674]
ecpbas  = []
    CPU time for pbc integral int3c1e_sph      8.23 sec, wall time      1.10 sec
slurmstepd: error: *** JOB 46996082 ON hpc-35-03 CANCELLED AT 2025-01-27T14:30:53 ***

OMP_NUM_THREADS = 64
MKL_NUM_THREADS = 1
PYSCF_MAX_MEMORY = 491520
TMPDIR = /central/scratch/yangjunjie//hg1212/47073333/
PYSCF_TMPDIR = /central/scratch/yangjunjie//hg1212/47073333/

/home/junjiey/anaconda3/envs/fftisdf/bin/python
2.7.0
1.14.1
1.26.4
WARNING!
  Very diffused basis functions are found in the basis set. They may lead to severe
  linear dependence and numerical instability.  You can set  cell.exp_to_discard=0.1
  to remove the diffused Gaussians whose exponents are less than 0.1.

#INFO: **** input file is /central/home/junjiey/work/fftisdf-benchmark/test/hg1212/main.py ****
import os, sys
import time

from libdmet.utils.iotools import read_poscar
import libdmet.utils.logger as log

TMPDIR = os.getenv("TMPDIR", None)
DATA_PATH = os.getenv("DATA_PATH", None)
PYSCF_MAX_MEMORY = os.getenv("PYSCF_MAX_MEMORY", 4000)
PYSCF_MAX_MEMORY = int(PYSCF_MAX_MEMORY)

log.verbose = "DEBUG1"

start = time.time()

# this is the number of doped holes
nelec_dop = 0

cell = read_poscar(fname="./Hg1212-2x2.vasp")

cell.basis = 'cc-pvdz.dat'
cell.pseudo = {
               'Cu1': 'GTH-PBE-q19', 
               'Cu2': 'GTH-PBE-q19',
               'O1': 'gth-pbe',
               'O2': 'gth-pbe',
               'Cu3': 'GTH-PBE-q19', 
               'Cu4': 'GTH-PBE-q19',
               'O3': 'gth-pbe',
               'O4': 'gth-pbe',
               'Hg': 'gth-pbe', 
               'Ba': 'gth-pbe',
               'Ca': 'gth-pbe'}

kmesh = [1, 1, 1]
cell.spin = 0
cell.verbose = 5
cell.precision = 1e-8
cell.ke_cutoff = 1000
cell.max_memory = PYSCF_MAX_MEMORY / 2
cell.build()

kpts = cell.get_kpts(kmesh)

from fft_isdf import ISDF
df_obj = ISDF(cell, kpts=kpts)
df_obj.c0 = 0.5
df_obj.tol = 1e-8
df_obj.verbose = 10
df_obj._isdf = os.path.join(TMPDIR, "tmp.chk")
df_obj.build()

#INFO: ******************** input file end ********************


System: uname_result(system='Linux', node='hpc-35-01.cm.cluster', release='5.14.0-362.24.1.el9_3.x86_64', version='#1 SMP PREEMPT_DYNAMIC Thu Feb 15 07:18:13 EST 2024', machine='x86_64')  Threads 64
Python 3.12.3 | packaged by conda-forge | (main, Apr 15 2024, 18:38:13) [GCC 12.3.0]
numpy 1.26.4  scipy 1.14.1  h5py 3.12.1
Date: Thu Jan 30 20:04:56 2025
PySCF version 2.7.0
PySCF path  /home/junjiey/anaconda3/envs/fftisdf/lib/python3.12/site-packages/pyscf

[ENV] PYSCF_TMPDIR /central/scratch/yangjunjie//hg1212/47073333/
[ENV] PYSCF_MAX_MEMORY 491520
[ENV] PYSCF_EXT_PATH /home/junjiey/packages/pyscf-forge/pyscf-forge-yangjunjie-non-orth/
[CONFIG] conf_file None
[INPUT] verbose = 5
[INPUT] max_memory = 245760.0 
[INPUT] num. atoms = 48
[INPUT] num. electrons = 464
[INPUT] charge = 0
[INPUT] spin (= nelec alpha-beta = 2S) = 0
[INPUT] symmetry False subgroup None
[INPUT] Mole.unit = A
[INPUT] Symbol           X                Y                Z      unit          X                Y                Z       unit  Magmom
[INPUT]  1 Cu1    1.927600000000   1.927600000000   4.760811090000 AA    3.642636077712   3.642636077712   8.996629090892 Bohr   0.0
[INPUT]  2 Cu1    5.782800000000   5.782800000000   4.760811090000 AA   10.927908233135  10.927908233135   8.996629090892 Bohr   0.0
[INPUT]  3 Cu2    1.927600000000   5.782800000000   4.760811090000 AA    3.642636077712  10.927908233135   8.996629090892 Bohr   0.0
[INPUT]  4 Cu2    5.782800000000   1.927600000000   4.760811090000 AA   10.927908233135   3.642636077712   8.996629090892 Bohr   0.0
[INPUT]  5 O1     1.927600000000   3.855200000000   4.770943170000 AA    3.642636077712   7.285272155423   9.015775947164 Bohr   0.0
[INPUT]  6 O1     3.855200000000   5.782800000000   4.770943170000 AA    7.285272155423  10.927908233135   9.015775947164 Bohr   0.0
[INPUT]  7 O1     5.782800000000   3.855200000000   4.770943170000 AA   10.927908233135   7.285272155423   9.015775947164 Bohr   0.0
[INPUT]  8 O1     3.855200000000   1.927600000000   4.770943170000 AA    7.285272155423   3.642636077712   9.015775947164 Bohr   0.0
[INPUT]  9 O1     0.000000000000   1.927600000000   4.770943170000 AA    0.000000000000   3.642636077712   9.015775947164 Bohr   0.0
[INPUT] 10 O1     1.927600000000   7.710400000000   4.770943170000 AA    3.642636077712  14.570544310846   9.015775947164 Bohr   0.0
[INPUT] 11 O1     7.710400000000   5.782800000000   4.770943170000 AA   14.570544310846  10.927908233135   9.015775947164 Bohr   0.0
[INPUT] 12 O1     5.782800000000   0.000000000000   4.770943170000 AA   10.927908233135   0.000000000000   9.015775947164 Bohr   0.0
[INPUT] 13 O2     1.927600000000   1.927600000000   1.985887680000 AA    3.642636077712   3.642636077712   3.752783829348 Bohr   0.0
[INPUT] 14 O2     1.927600000000   5.782800000000   1.985887680000 AA    3.642636077712  10.927908233135   3.752783829348 Bohr   0.0
[INPUT] 15 O2     5.782800000000   1.927600000000   1.985887680000 AA   10.927908233135   3.642636077712   3.752783829348 Bohr   0.0
[INPUT] 16 O2     5.782800000000   5.782800000000   1.985887680000 AA   10.927908233135  10.927908233135   3.752783829348 Bohr   0.0
[INPUT] 17 Cu3    1.927600000000   1.927600000000   7.904288910000 AA    3.642636077712   3.642636077712  14.936941249337 Bohr   0.0
[INPUT] 18 Cu3    5.782800000000   5.782800000000   7.904288910000 AA   10.927908233135  10.927908233135  14.936941249337 Bohr   0.0
[INPUT] 19 Cu4    1.927600000000   5.782800000000   7.904288910000 AA    3.642636077712  10.927908233135  14.936941249337 Bohr   0.0
[INPUT] 20 Cu4    5.782800000000   1.927600000000   7.904288910000 AA   10.927908233135   3.642636077712  14.936941249337 Bohr   0.0
[INPUT] 21 O3     1.927600000000   3.855200000000   7.894156830000 AA    3.642636077712   7.285272155423  14.917794393065 Bohr   0.0
[INPUT] 22 O3     3.855200000000   5.782800000000   7.894156830000 AA    7.285272155423  10.927908233135  14.917794393065 Bohr   0.0
[INPUT] 23 O3     5.782800000000   3.855200000000   7.894156830000 AA   10.927908233135   7.285272155423  14.917794393065 Bohr   0.0
[INPUT] 24 O3     3.855200000000   1.927600000000   7.894156830000 AA    7.285272155423   3.642636077712  14.917794393065 Bohr   0.0
[INPUT] 25 O3     0.000000000000   1.927600000000   7.894156830000 AA    0.000000000000   3.642636077712  14.917794393065 Bohr   0.0
[INPUT] 26 O3     1.927600000000   7.710400000000   7.894156830000 AA    3.642636077712  14.570544310846  14.917794393065 Bohr   0.0
[INPUT] 27 O3     7.710400000000   5.782800000000   7.894156830000 AA   14.570544310846  10.927908233135  14.917794393065 Bohr   0.0
[INPUT] 28 O3     5.782800000000   0.000000000000   7.894156830000 AA   10.927908233135   0.000000000000  14.917794393065 Bohr   0.0
[INPUT] 29 O4     1.927600000000   1.927600000000  10.679212320000 AA    3.642636077712   3.642636077712  20.180786510881 Bohr   0.0
[INPUT] 30 O4     1.927600000000   5.782800000000  10.679212320000 AA    3.642636077712  10.927908233135  20.180786510881 Bohr   0.0
[INPUT] 31 O4     5.782800000000   1.927600000000  10.679212320000 AA   10.927908233135   3.642636077712  20.180786510881 Bohr   0.0
[INPUT] 32 O4     5.782800000000   5.782800000000  10.679212320000 AA   10.927908233135  10.927908233135  20.180786510881 Bohr   0.0
[INPUT] 33 Hg     1.927600000000   1.927600000000   0.000000000000 AA    3.642636077712   3.642636077712   0.000000000000 Bohr   0.0
[INPUT] 34 Hg     5.782800000000   5.782800000000   0.000000000000 AA   10.927908233135  10.927908233135   0.000000000000 Bohr   0.0
[INPUT] 35 Hg     1.927600000000   5.782800000000   0.000000000000 AA    3.642636077712  10.927908233135   0.000000000000 Bohr   0.0
[INPUT] 36 Hg     5.782800000000   1.927600000000   0.000000000000 AA   10.927908233135   3.642636077712   0.000000000000 Bohr   0.0
[INPUT] 37 Ba     0.000000000000   3.855200000000   2.786322000000 AA    0.000000000000   7.285272155423   5.265385474850 Bohr   0.0
[INPUT] 38 Ba     3.855200000000   7.710400000000   2.786322000000 AA    7.285272155423  14.570544310846   5.265385474850 Bohr   0.0
[INPUT] 39 Ba     3.855200000000   3.855200000000   2.786322000000 AA    7.285272155423   7.285272155423   5.265385474850 Bohr   0.0
[INPUT] 40 Ba     7.710400000000   0.000000000000   2.786322000000 AA   14.570544310846   0.000000000000   5.265385474850 Bohr   0.0
[INPUT] 41 Ba     0.000000000000   3.855200000000   9.878778000000 AA    0.000000000000   7.285272155423  18.668184865379 Bohr   0.0
[INPUT] 42 Ba     3.855200000000   7.710400000000   9.878778000000 AA    7.285272155423  14.570544310846  18.668184865379 Bohr   0.0
[INPUT] 43 Ba     3.855200000000   3.855200000000   9.878778000000 AA    7.285272155423   7.285272155423  18.668184865379 Bohr   0.0
[INPUT] 44 Ba     7.710400000000   0.000000000000   9.878778000000 AA   14.570544310846   0.000000000000  18.668184865379 Bohr   0.0
[INPUT] 45 Ca     0.000000000000   3.855200000000   6.332550000000 AA    0.000000000000   7.285272155423  11.966785170114 Bohr   0.0
[INPUT] 46 Ca     3.855200000000   7.710400000000   6.332550000000 AA    7.285272155423  14.570544310846  11.966785170114 Bohr   0.0
[INPUT] 47 Ca     3.855200000000   3.855200000000   6.332550000000 AA    7.285272155423   7.285272155423  11.966785170114 Bohr   0.0
[INPUT] 48 Ca     7.710400000000   0.000000000000   6.332550000000 AA   14.570544310846   0.000000000000  11.966785170114 Bohr   0.0
[INPUT] ---------------- BASIS SET ---------------- 
[INPUT] l, kappa, [nprim/nctr], expnt,             c_1 c_2 ...
[INPUT] O4
[INPUT] 0    0    [5    /1   ]  14.482841         -0.03658934
                                6.284704          -0.1303224
                                1.164884          0.3769821
                                0.468441          0.5431582
                                0.184961          0.208414
[INPUT] 0    0    [1    /1   ]  0.221262             1
[INPUT] 1    0    [5    /1   ]  10.213949         0.06086918
                                3.622324          0.1870524
                                1.299051          0.3714779
                                0.463791          0.4256889
                                0.157848          0.208873
[INPUT] 1    0    [1    /1   ]  0.27467              1
[INPUT] 2    0    [1    /1   ]  1.200187             1
[INPUT] Ba
[INPUT] 0    0    [3    /2   ]  4.860079          -0.02877241 0.02157408
                                1.399001          0.3828487 -0.2577906
                                0.40271           -0.784284 0.3891714
[INPUT] 0    0    [1    /1   ]  0.115922             1
[INPUT] 0    0    [1    /1   ]  0.033369             1
[INPUT] 1    0    [4    /1   ]  3.592628          0.04674179
                                1.573935          -0.351962
                                0.689543          0.5167405
                                0.30209           0.7478454
[INPUT] 1    0    [1    /1   ]  0.132346             1
[INPUT] 1    0    [1    /1   ]  0.042656             1
[INPUT] 2    0    [5    /1   ]  1.680976          0.05054502
                                0.883691          -0.07506956
                                0.464558          -0.05025319
                                0.244219          -0.4749195
                                0.128386          0.1435246
[INPUT] 2    0    [1    /1   ]  0.067493             1
[INPUT] Cu3
[INPUT] 0    0    [4    /2   ]  9.083669          -0.3622183 0.1093857
                                2.375895          0.7613242 -0.1645715
                                0.936687          0.5169596 0.03951353
                                0.116029          -0.08984813 -0.6615456
[INPUT] 0    0    [1    /1   ]  0.041075             1
[INPUT] 1    0    [5    /2   ]  11.566615         -0.1354626 0.02324231
                                4.918638          0.4749338 -0.075312
                                2.290556          0.709813 -0.02250031
                                1.043427          0.4923407 -0.1498897
                                0.429044          0.09926123 0.1645767
[INPUT] 1    0    [1    /1   ]  0.13904              1
[INPUT] 2    0    [3    /1   ]  8.082843          -0.3663286
                                3.149999          -0.5868172
                                1.067441          -0.6124219
[INPUT] 2    0    [1    /1   ]  0.308911             1
[INPUT] 3    0    [2    /1   ]  4.078302          -0.4962922
                                1.072255          -0.8681555
[INPUT] Cu1
[INPUT] 0    0    [4    /2   ]  9.083669          -0.3622183 0.1093857
                                2.375895          0.7613242 -0.1645715
                                0.936687          0.5169596 0.03951353
                                0.116029          -0.08984813 -0.6615456
[INPUT] 0    0    [1    /1   ]  0.041075             1
[INPUT] 1    0    [5    /2   ]  11.566615         -0.1354626 0.02324231
                                4.918638          0.4749338 -0.075312
                                2.290556          0.709813 -0.02250031
                                1.043427          0.4923407 -0.1498897
                                0.429044          0.09926123 0.1645767
[INPUT] 1    0    [1    /1   ]  0.13904              1
[INPUT] 2    0    [3    /1   ]  8.082843          -0.3663286
                                3.149999          -0.5868172
                                1.067441          -0.6124219
[INPUT] 2    0    [1    /1   ]  0.308911             1
[INPUT] 3    0    [2    /1   ]  4.078302          -0.4962922
                                1.072255          -0.8681555
[INPUT] Cu2
[INPUT] 0    0    [4    /2   ]  9.083669          -0.3622183 0.1093857
                                2.375895          0.7613242 -0.1645715
                                0.936687          0.5169596 0.03951353
                                0.116029          -0.08984813 -0.6615456
[INPUT] 0    0    [1    /1   ]  0.041075             1
[INPUT] 1    0    [5    /2   ]  11.566615         -0.1354626 0.02324231
                                4.918638          0.4749338 -0.075312
                                2.290556          0.709813 -0.02250031
                                1.043427          0.4923407 -0.1498897
                                0.429044          0.09926123 0.1645767
[INPUT] 1    0    [1    /1   ]  0.13904              1
[INPUT] 2    0    [3    /1   ]  8.082843          -0.3663286
                                3.149999          -0.5868172
                                1.067441          -0.6124219
[INPUT] 2    0    [1    /1   ]  0.308911             1
[INPUT] 3    0    [2    /1   ]  4.078302          -0.4962922
                                1.072255          -0.8681555
[INPUT] Hg
[INPUT] 0    0    [2    /1   ]  1.9157            0.135789
                                0.979308          -0.4520937
[INPUT] 0    0    [1    /1   ]  0.150255             1
[INPUT] 0    0    [1    /1   ]  0.054019             1
[INPUT] 1    0    [2    /1   ]  2.173806          -0.008329602
                                0.867935          0.04694467
[INPUT] 1    0    [1    /1   ]  0.34654              1
[INPUT] 1    0    [1    /1   ]  0.138363             1
[INPUT] 2    0    [3    /1   ]  3.674806          0.02455544
                                1.622342          -0.6047205
                                0.768788          -0.6547334
[INPUT] 2    0    [1    /1   ]  0.339247             1
[INPUT] 2    0    [1    /1   ]  0.136379             1
[INPUT] 3    0    [2    /1   ]  1.330141          0.5428473
                                0.507359          0.8398314
[INPUT] Cu4
[INPUT] 0    0    [4    /2   ]  9.083669          -0.3622183 0.1093857
                                2.375895          0.7613242 -0.1645715
                                0.936687          0.5169596 0.03951353
                                0.116029          -0.08984813 -0.6615456
[INPUT] 0    0    [1    /1   ]  0.041075             1
[INPUT] 1    0    [5    /2   ]  11.566615         -0.1354626 0.02324231
                                4.918638          0.4749338 -0.075312
                                2.290556          0.709813 -0.02250031
                                1.043427          0.4923407 -0.1498897
                                0.429044          0.09926123 0.1645767
[INPUT] 1    0    [1    /1   ]  0.13904              1
[INPUT] 2    0    [3    /1   ]  8.082843          -0.3663286
                                3.149999          -0.5868172
                                1.067441          -0.6124219
[INPUT] 2    0    [1    /1   ]  0.308911             1
[INPUT] 3    0    [2    /1   ]  4.078302          -0.4962922
                                1.072255          -0.8681555
[INPUT] O1
[INPUT] 0    0    [5    /1   ]  14.482841         -0.03658934
                                6.284704          -0.1303224
                                1.164884          0.3769821
                                0.468441          0.5431582
                                0.184961          0.208414
[INPUT] 0    0    [1    /1   ]  0.221262             1
[INPUT] 1    0    [5    /1   ]  10.213949         0.06086918
                                3.622324          0.1870524
                                1.299051          0.3714779
                                0.463791          0.4256889
                                0.157848          0.208873
[INPUT] 1    0    [1    /1   ]  0.27467              1
[INPUT] 2    0    [1    /1   ]  1.200187             1
[INPUT] Ca
[INPUT] 0    0    [4    /2   ]  7.213557          -0.04811677 0.06509227
                                3.953199          0.2795449 -0.3375291
                                0.887945          -0.5055939 0.5085903
                                0.381928          -0.4403097 0.318967
[INPUT] 0    0    [1    /1   ]  0.044801             1
[INPUT] 1    0    [4    /2   ]  5.522531          0.06327636 0.004842917
                                1.446307          -0.5437431 -0.003188125
                                0.605733          -0.788295 -0.06033881
                                0.239083          -0.280026 0.09655471
[INPUT] 1    0    [1    /1   ]  0.062765             1
[INPUT] 2    0    [4    /1   ]  3.010924          0.04928622
                                1.064269          0.1087188
                                0.31668           0.210131
                                0.175804          -0.03737671
[INPUT] 2    0    [1    /1   ]  0.073715             1
[INPUT] O3
[INPUT] 0    0    [5    /1   ]  14.482841         -0.03658934
                                6.284704          -0.1303224
                                1.164884          0.3769821
                                0.468441          0.5431582
                                0.184961          0.208414
[INPUT] 0    0    [1    /1   ]  0.221262             1
[INPUT] 1    0    [5    /1   ]  10.213949         0.06086918
                                3.622324          0.1870524
                                1.299051          0.3714779
                                0.463791          0.4256889
                                0.157848          0.208873
[INPUT] 1    0    [1    /1   ]  0.27467              1
[INPUT] 2    0    [1    /1   ]  1.200187             1
[INPUT] O2
[INPUT] 0    0    [5    /1   ]  14.482841         -0.03658934
                                6.284704          -0.1303224
                                1.164884          0.3769821
                                0.468441          0.5431582
                                0.184961          0.208414
[INPUT] 0    0    [1    /1   ]  0.221262             1
[INPUT] 1    0    [5    /1   ]  10.213949         0.06086918
                                3.622324          0.1870524
                                1.299051          0.3714779
                                0.463791          0.4256889
                                0.157848          0.208873
[INPUT] 1    0    [1    /1   ]  0.27467              1
[INPUT] 2    0    [1    /1   ]  1.200187             1

Ewald components = 514.671494873007, -1896.43816646742, 440.44678037039
nuclear repulsion = -941.319891224022
number of shells = 304
number of NR pGTOs = 1976
number of NR cGTOs = 952
basis = cc-pvdz.dat
ecp = {}
CPU time:        11.54
lattice vectors  a1 [14.570544311, 0.000000000, 0.000000000]
                 a2 [0.000000000, 14.570544311, 0.000000000]
                 a3 [0.000000000, 0.000000000, 23.933570340]
dimension = 3
low_dim_ft_type = None
Cell volume = 5081.12
rcut = 37.04881233010331 (nimgs = [3 3 2])
lattice sum = 447 cells
precision = 1e-08
pseudo = {'Cu1': 'GTH-PBE-q19', 'Cu2': 'GTH-PBE-q19', 'O1': 'gth-pbe', 'O2': 'gth-pbe', 'Cu3': 'GTH-PBE-q19', 'Cu4': 'GTH-PBE-q19', 'O3': 'gth-pbe', 'O4': 'gth-pbe', 'Hg': 'gth-pbe', 'Ba': 'gth-pbe', 'Ca': 'gth-pbe'}
ke_cutoff = 1000
    = [209 209 343] mesh (14982583 PWs)


******** <class 'fft_isdf.InterpolativeSeparableDensityFitting'> ********
mesh = [209 209 343] (14982583 PWs)
len(kpts) = 1
    kpts = [[0. 0. 0.]]
Overwritten attributes  tol c0 kmesh  of <class 'fft_isdf.InterpolativeSeparableDensityFitting'>
kmesh = [1 1 1]
Input parent grid mesh = [8, 8, 8], ke_cutoff =   2.99
Final parent grid size = [ 9  7 11]

Selecting interpolation points
nkpts = 1, nao = 952, c0 =   0.50
Parent grid mesh = [ 9  7 11], grid size = 693

WARN: The parent grid might be too coarse.

    CPU time for select interpolation points      2.90 sec, wall time      0.05 sec
Pivoted Cholesky rank = 693, nip = 476, estimated error = 6.16e-02
Number of interpolation points = 476, effective CISDF =   0.50
    CPU time for building left-hand side      9.82 sec, wall time      0.15 sec

kpt = 1, ngrid = 14982583, nao = 952
ngrid = 14982583, blksize = 3219723, nip = 476
required disk space = 114 GB
finished creating fswp: /central/scratch/yangjunjie/hg1212/47073333/5s1nry8i
blksize = 3219723, memory for aoR_loop = 24521 MB
finished aoR_loop[       0: 3219723]

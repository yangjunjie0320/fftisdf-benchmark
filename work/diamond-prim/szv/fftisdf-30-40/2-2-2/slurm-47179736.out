OMP_NUM_THREADS = 64
MKL_NUM_THREADS = 1
PYSCF_MAX_MEMORY = 491520
TMPDIR = /central/scratch/yangjunjie//work/diamond-prim/szv/fftisdf-30-40/2-2-2//47179736/
PYSCF_TMPDIR = /central/scratch/yangjunjie//work/diamond-prim/szv/fftisdf-30-40/2-2-2//47179736/
rm: invalid option -- 'p'
Try 'rm --help' for more information.

/home/junjiey/anaconda3/envs/fftisdf/bin/python
2.8.0
1.13.1
1.26.4


******** <class 'fft_isdf.InterpolativeSeparableDensityFitting'> ********
mesh = [15 15 15] (3375 PWs)
len(kpts) = 8
    kpts = [[ 0.          0.          0.        ]
 [-0.38121014 -0.26955632  0.66027542]
 [ 0.          0.80866896  0.        ]
 [-0.38121014  0.53911264  0.66027542]
 [ 0.76242029 -0.26955632  0.        ]
 [ 0.38121014 -0.53911264  0.66027542]
 [ 0.76242029  0.53911264  0.        ]
 [ 0.38121014  0.26955632  0.66027542]]
Overwritten attributes  c0 kmesh tol  of <class 'fft_isdf.InterpolativeSeparableDensityFitting'>

WARN: ke_cutoff/mesh (40 / [15 15 15]) is not enough for FFTDF to get integral accuracy 1e-10.
Coulomb integral error is ~ 8.8 Eh.
Recommended ke_cutoff/mesh are 635.334 / [55 55 55].

kmesh = [2 2 2]
Input parent grid mesh = [7, 7, 7], ke_cutoff =  28.02
Final parent grid size = [9 7 9]

Selecting interpolation points
nkpts = 8, nao = 8, c0 =  30.00
Parent grid mesh = [9 7 9], grid size = 567

WARN: The parent grid might be too coarse.

    CPU time for select interpolation points     20.55 sec, wall time      0.33 sec
Pivoted Cholesky rank = 567, nip = 240, estimated error = 1.92e-03
Number of interpolation points = 240, effective CISDF =  30.00
    CPU time for building left-hand side      2.04 sec, wall time      0.03 sec

kpt = 8, ngrid = 3375, nao = 8
ngrid = 3375, blksize = 1598731, nip = 240
required disk space = 0 GB
finished creating fswp: /central/scratch/yangjunjie/work/diamond-prim/szv/fftisdf-30-40/2-2-2/47179736/gzvl8mfk
blksize = 1598731, memory for aoR_loop = 49113 MB
finished aoR_loop[       0:    3375]
    CPU time for building right-hand side     30.91 sec, wall time      0.49 sec
w[  0], rank =   51 /  240
    CPU time for w[  0]      9.66 sec, wall time      0.16 sec
w[  1], rank =   50 /  240
    CPU time for w[  1]      6.51 sec, wall time      0.10 sec
w[  2], rank =   50 /  240
    CPU time for w[  2]      7.15 sec, wall time      0.11 sec
w[  3], rank =   50 /  240
    CPU time for w[  3]      7.03 sec, wall time      0.11 sec
w[  4], rank =   50 /  240
    CPU time for w[  4]      6.42 sec, wall time      0.10 sec
w[  5], rank =   50 /  240
    CPU time for w[  5]      6.77 sec, wall time      0.11 sec
w[  6], rank =   50 /  240
    CPU time for w[  6]      8.47 sec, wall time      0.13 sec
w[  7], rank =   50 /  240
    CPU time for w[  7]      7.63 sec, wall time      0.12 sec
Saving FFTISDF results to /central/scratch/yangjunjie//work/diamond-prim/szv/fftisdf-30-40/2-2-2//47179736/tmp.chk
    CPU time for building ISDF    118.61 sec, wall time      1.90 sec
(8, 8, 8) (8, 8, 8) (1, 8, 8, 8)
Traceback (most recent call last):
  File "/central/home/junjiey/work/fftisdf-benchmark-new/work/diamond-prim/szv/fftisdf-30-40/2-2-2/main.py", line 46, in <module>
    main(args)
  File "/central/home/junjiey/work/fftisdf-benchmark-new/work/diamond-prim/szv/fftisdf-30-40/2-2-2/main.py", line 33, in main
    scf(cell, kmesh, df_obj=df_obj, tmp=df_obj._isdf)
  File "/home/junjiey/work/fftisdf-benchmark-new/src/utils.py", line 126, in scf
    e_tot = scf_obj.kernel(dm0)
  File "<string>", line 2, in kernel
  File "/home/junjiey/anaconda3/envs/fftisdf/lib/python3.9/site-packages/pyscf/scf/hf.py", line 2016, in scf
    kernel(self, self.conv_tol, self.conv_tol_grad,
  File "/home/junjiey/anaconda3/envs/fftisdf/lib/python3.9/site-packages/pyscf/scf/hf.py", line 130, in kernel
    e_tot = mf.energy_tot(dm, h1e, vhf)
  File "/home/junjiey/anaconda3/envs/fftisdf/lib/python3.9/site-packages/pyscf/scf/addons.py", line 242, in energy_tot
    e_tot = self.energy_elec(dm, h1e, vhf)[0] + self.energy_nuc()
  File "/home/junjiey/anaconda3/envs/fftisdf/lib/python3.9/site-packages/pyscf/pbc/scf/khf.py", line 250, in energy_elec
    e_coul = 1./nkpts * np.einsum('kij,kji', dm_kpts, vhf_kpts) * 0.5
  File "/home/junjiey/anaconda3/envs/fftisdf/lib/python3.9/site-packages/numpy/core/einsumfunc.py", line 1371, in einsum
    return c_einsum(*operands, **kwargs)
ValueError: operand has more dimensions than subscripts given in einstein sum, but no '...' ellipsis provided to broadcast the extra dimensions.

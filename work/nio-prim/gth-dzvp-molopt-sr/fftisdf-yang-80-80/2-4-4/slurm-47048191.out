OMP_NUM_THREADS = 64
MKL_NUM_THREADS = 1
PYSCF_MAX_MEMORY = 491520
TMPDIR = /central/scratch/yangjunjie//work/nio-prim/gth-dzvp-molopt-sr/fftisdf-yang-80-80/2-4-4//47048191/
PYSCF_TMPDIR = /central/scratch/yangjunjie//work/nio-prim/gth-dzvp-molopt-sr/fftisdf-yang-80-80/2-4-4//47048191/

/home/junjiey/anaconda3/envs/fftisdf/bin/python
2.7.0
1.14.1
1.26.4


******** <class 'fft_isdf.InterpolativeSeparableDensityFitting'> ********
mesh = [25 25 25] (15625 PWs)
len(kpts) = 32
    kpts = [[ 0.00000000e+00  0.00000000e+00  0.00000000e+00]
 [-1.62121641e-01 -1.14637399e-01  2.80803037e-01]
 [-3.24243283e-01 -2.29274798e-01  5.61606073e-01]
 [-4.86364924e-01 -3.43912196e-01  8.42409110e-01]
 [ 1.34152098e-09  3.43912129e-01  0.00000000e+00]
 [-1.62121640e-01  2.29274730e-01  2.80803037e-01]
 [-3.24243281e-01  1.14637331e-01  5.61606073e-01]
 [-4.86364922e-01 -6.72557783e-08  8.42409110e-01]
 [ 2.68304197e-09  6.87824258e-01  0.00000000e+00]
 [-1.62121639e-01  5.73186859e-01  2.80803037e-01]
 [-3.24243280e-01  4.58549461e-01  5.61606073e-01]
 [-4.86364921e-01  3.43912062e-01  8.42409110e-01]
 [ 4.02456295e-09  1.03173639e+00  0.00000000e+00]
 [-1.62121637e-01  9.17098988e-01  2.80803037e-01]
 [-3.24243278e-01  8.02461590e-01  5.61606073e-01]
 [-4.86364920e-01  6.87824191e-01  8.42409110e-01]
 [ 6.48486565e-01 -2.29274661e-01  0.00000000e+00]
 [ 4.86364923e-01 -3.43912060e-01  2.80803037e-01]
 [ 3.24243282e-01 -4.58549459e-01  5.61606073e-01]
 [ 1.62121641e-01 -5.73186858e-01  8.42409110e-01]
 [ 6.48486566e-01  1.14637468e-01  0.00000000e+00]
 [ 4.86364925e-01  6.88048341e-08  2.80803037e-01]
 [ 3.24243283e-01 -1.14637330e-01  5.61606073e-01]
 [ 1.62121642e-01 -2.29274729e-01  8.42409110e-01]
 [ 6.48486567e-01  4.58549597e-01  0.00000000e+00]
 [ 4.86364926e-01  3.43912198e-01  2.80803037e-01]
 [ 3.24243285e-01  2.29274799e-01  5.61606073e-01]
 [ 1.62121643e-01  1.14637400e-01  8.42409110e-01]
 [ 6.48486569e-01  8.02461726e-01  0.00000000e+00]
 [ 4.86364927e-01  6.87824327e-01  2.80803037e-01]
 [ 3.24243286e-01  5.73186928e-01  5.61606073e-01]
 [ 1.62121645e-01  4.58549529e-01  8.42409110e-01]]
Overwritten attributes  kmesh c0 tol  of <class 'fft_isdf.InterpolativeSeparableDensityFitting'>

WARN: ke_cutoff/mesh (80 / [25 25 25]) is not enough for FFTDF to get integral accuracy 1e-10.
Coulomb integral error is ~ 1.5e+02 Eh.
Recommended ke_cutoff/mesh are 1368.68 / [95 95 95].

kmesh = [2 4 4]
Input parent grid mesh = [15, 15, 15], ke_cutoff = 110.38
Final parent grid size = [17 15 17]

Selecting interpolation points
nkpts = 32, nao = 39, c0 =  80.00
Parent grid mesh = [17 15 17], grid size = 4335
    CPU time for select interpolation points    415.91 sec, wall time      7.23 sec
Pivoted Cholesky rank = 4127, nip = 3120, estimated error = 3.95e-06
Number of interpolation points = 3120, effective CISDF =  80.00
    CPU time for building left-hand side     94.31 sec, wall time      3.71 sec

kpt = 32, ngrid = 15625, nao = 39
ngrid = 15625, blksize = 30423, nip = 3120
required disk space = 24 GB
finished creating fswp: /central/scratch/yangjunjie/work/nio-prim/gth-dzvp-molopt-sr/fftisdf-yang-80-80/2-4-4/47048191/3v6notl7
blksize = 30423, memory for aoR_loop = 48598 MB
finished aoR_loop[       0:   15625]
    CPU time for building right-hand side    262.16 sec, wall time     25.85 sec
w[  0], rank =  194 / 3120
    CPU time for w[  0]   2319.64 sec, wall time     39.60 sec
w[  1], rank =  194 / 3120
    CPU time for w[  1]   2029.44 sec, wall time     34.07 sec
w[  2], rank =  194 / 3120
    CPU time for w[  2]    531.09 sec, wall time      9.73 sec
w[  3], rank =  194 / 3120
    CPU time for w[  3]    513.28 sec, wall time      9.55 sec
w[  4], rank =  194 / 3120
    CPU time for w[  4]    648.13 sec, wall time     11.54 sec
w[  5], rank =  194 / 3120
    CPU time for w[  5]    515.23 sec, wall time      9.38 sec
w[  6], rank =  194 / 3120
    CPU time for w[  6]    642.35 sec, wall time     11.78 sec
w[  7], rank =  194 / 3120
    CPU time for w[  7]   4465.99 sec, wall time     75.80 sec
w[  8], rank =  194 / 3120
    CPU time for w[  8]   7590.48 sec, wall time    122.81 sec
w[  9], rank =  194 / 3120
    CPU time for w[  9]   1928.51 sec, wall time     31.89 sec
w[ 10], rank =  194 / 3120
    CPU time for w[ 10]   2015.83 sec, wall time     33.22 sec
w[ 11], rank =  194 / 3120
    CPU time for w[ 11]    480.10 sec, wall time      9.01 sec
w[ 12], rank =  194 / 3120
    CPU time for w[ 12]   1375.27 sec, wall time     23.44 sec
w[ 13], rank =  194 / 3120
    CPU time for w[ 13]    506.77 sec, wall time      9.27 sec
w[ 14], rank =  194 / 3120
    CPU time for w[ 14]   1407.76 sec, wall time     23.62 sec
w[ 15], rank =  194 / 3120
    CPU time for w[ 15]   4992.36 sec, wall time     81.86 sec
w[ 16], rank =  194 / 3120
    CPU time for w[ 16]   4940.19 sec, wall time     82.22 sec
w[ 17], rank =  194 / 3120
    CPU time for w[ 17]   3338.68 sec, wall time     56.30 sec
w[ 18], rank =  194 / 3120
    CPU time for w[ 18]    442.98 sec, wall time      8.19 sec
w[ 19], rank =  194 / 3120
    CPU time for w[ 19]    512.19 sec, wall time      9.30 sec
w[ 20], rank =  194 / 3120
    CPU time for w[ 20]    518.37 sec, wall time      9.42 sec
w[ 21], rank =  194 / 3120
    CPU time for w[ 21]    572.81 sec, wall time     10.34 sec
w[ 22], rank =  194 / 3120
    CPU time for w[ 22]    631.46 sec, wall time     11.25 sec
w[ 23], rank =  194 / 3120
    CPU time for w[ 23]    554.71 sec, wall time     10.03 sec
w[ 24], rank =  194 / 3120
    CPU time for w[ 24]   4787.22 sec, wall time     79.60 sec
w[ 25], rank =  194 / 3120
    CPU time for w[ 25]   3606.99 sec, wall time     59.33 sec
w[ 26], rank =  194 / 3120
    CPU time for w[ 26]   1166.52 sec, wall time     20.12 sec
w[ 27], rank =  194 / 3120
    CPU time for w[ 27]    489.04 sec, wall time      8.94 sec
w[ 28], rank =  194 / 3120
    CPU time for w[ 28]    536.94 sec, wall time      9.75 sec
w[ 29], rank =  194 / 3120
    CPU time for w[ 29]   1868.93 sec, wall time     31.10 sec
w[ 30], rank =  194 / 3120
    CPU time for w[ 30]    469.37 sec, wall time      8.58 sec
w[ 31], rank =  194 / 3120
    CPU time for w[ 31]    514.50 sec, wall time      9.32 sec
Saving FFTISDF results to /central/scratch/yangjunjie//work/nio-prim/gth-dzvp-molopt-sr/fftisdf-yang-80-80/2-4-4//47048191/tmp.chk
    CPU time for building ISDF  57701.59 sec, wall time   1000.15 sec
Traceback (most recent call last):
  File "/central/home/junjiey/work/fftisdf-benchmark/work/nio-prim/gth-dzvp-molopt-sr/fftisdf-yang-80-80/2-4-4/main.py", line 46, in <module>
    main(args)
  File "/central/home/junjiey/work/fftisdf-benchmark/work/nio-prim/gth-dzvp-molopt-sr/fftisdf-yang-80-80/2-4-4/main.py", line 33, in main
    get_jk_time(cell, kmesh, df_obj=df_obj, tmp=df_obj._isdf)
  File "/home/junjiey/work/fftisdf-benchmark/src/utils.py", line 90, in get_jk_time
    dump("vjk.chk", "vj", vj1)
  File "/home/junjiey/anaconda3/envs/fftisdf/lib/python3.12/site-packages/pyscf/lib/chkfile.py", line 138, in dump
    save_as_group(key, value, fh5)
  File "/home/junjiey/anaconda3/envs/fftisdf/lib/python3.12/site-packages/pyscf/lib/chkfile.py", line 120, in save_as_group
    root[key] = value
    ~~~~^^^^^
  File "/home/junjiey/anaconda3/envs/fftisdf/lib/python3.12/site-packages/h5py/_hl/group.py", line 483, in __setitem__
    ds = self.create_dataset(None, data=obj)
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/junjiey/anaconda3/envs/fftisdf/lib/python3.12/site-packages/h5py/_hl/group.py", line 183, in create_dataset
    dsid = dataset.make_new_dset(group, shape, dtype, data, name, **kwds)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/junjiey/anaconda3/envs/fftisdf/lib/python3.12/site-packages/h5py/_hl/dataset.py", line 168, in make_new_dset
    dset_id.write(h5s.ALL, h5s.ALL, data)
  File "h5py/_objects.pyx", line 54, in h5py._objects.with_phil.wrapper
  File "h5py/_objects.pyx", line 55, in h5py._objects.with_phil.wrapper
  File "h5py/h5d.pyx", line 281, in h5py.h5d.DatasetID.write
  File "h5py/_proxy.pyx", line 115, in h5py._proxy.dset_rw
OSError: [Errno 122] Can't write data (file write failed: time = Thu Jan 30 00:45:34 2025
, filename = 'vjk.chk', file descriptor = 7, errno = 122, error message = 'Disk quota exceeded', buf = 0x55f51deb1d50, total write size = 778752, bytes this sub-write = 778752, bytes actually written = 18446744073709551615, offset = 0)

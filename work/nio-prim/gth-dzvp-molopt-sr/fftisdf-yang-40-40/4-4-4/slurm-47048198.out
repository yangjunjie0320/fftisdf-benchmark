OMP_NUM_THREADS = 64
MKL_NUM_THREADS = 1
PYSCF_MAX_MEMORY = 491520
TMPDIR = /central/scratch/yangjunjie//work/nio-prim/gth-dzvp-molopt-sr/fftisdf-yang-40-40/4-4-4//47048198/
PYSCF_TMPDIR = /central/scratch/yangjunjie//work/nio-prim/gth-dzvp-molopt-sr/fftisdf-yang-40-40/4-4-4//47048198/

/home/junjiey/anaconda3/envs/fftisdf/bin/python
2.7.0
1.14.1
1.26.4


******** <class 'fft_isdf.InterpolativeSeparableDensityFitting'> ********
mesh = [17 17 17] (4913 PWs)
len(kpts) = 64
    kpts = [[ 0.00000000e+00  0.00000000e+00  0.00000000e+00]
 [-1.62121641e-01 -1.14637399e-01  2.80803037e-01]
 [-3.24243283e-01 -2.29274798e-01  5.61606073e-01]
 [-4.86364924e-01 -3.43912196e-01  8.42409110e-01]
 [ 1.34152098e-09  3.43912129e-01  0.00000000e+00]
 [-1.62121640e-01  2.29274730e-01  2.80803037e-01]
 [-3.24243281e-01  1.14637331e-01  5.61606073e-01]
 [-4.86364922e-01 -6.72557783e-08  8.42409110e-01]
 [ 2.68304197e-09  6.87824258e-01  0.00000000e+00]
 [-1.62121639e-01  5.73186859e-01  2.80803037e-01]
 [-3.24243280e-01  4.58549461e-01  5.61606073e-01]
 [-4.86364921e-01  3.43912062e-01  8.42409110e-01]
 [ 4.02456295e-09  1.03173639e+00  0.00000000e+00]
 [-1.62121637e-01  9.17098988e-01  2.80803037e-01]
 [-3.24243278e-01  8.02461590e-01  5.61606073e-01]
 [-4.86364920e-01  6.87824191e-01  8.42409110e-01]
 [ 3.24243282e-01 -1.14637331e-01  0.00000000e+00]
 [ 1.62121641e-01 -2.29274729e-01  2.80803037e-01]
 [-2.46173915e-10 -3.43912128e-01  5.61606073e-01]
 [-1.62121642e-01 -4.58549527e-01  8.42409110e-01]
 [ 3.24243284e-01  2.29274798e-01  0.00000000e+00]
 [ 1.62121642e-01  1.14637400e-01  2.80803037e-01]
 [ 1.09534709e-09  7.74527886e-10  5.61606073e-01]
 [-1.62121640e-01 -1.14637398e-01  8.42409110e-01]
 [ 3.24243285e-01  5.73186927e-01  0.00000000e+00]
 [ 1.62121644e-01  4.58549529e-01  2.80803037e-01]
 [ 2.43686804e-09  3.43912130e-01  5.61606073e-01]
 [-1.62121639e-01  2.29274731e-01  8.42409110e-01]
 [ 3.24243286e-01  9.17099056e-01  0.00000000e+00]
 [ 1.62121645e-01  8.02461658e-01  2.80803037e-01]
 [ 3.77838905e-09  6.87824259e-01  5.61606073e-01]
 [-1.62121637e-01  5.73186860e-01  8.42409110e-01]
 [ 6.48486565e-01 -2.29274661e-01  0.00000000e+00]
 [ 4.86364923e-01 -3.43912060e-01  2.80803037e-01]
 [ 3.24243282e-01 -4.58549459e-01  5.61606073e-01]
 [ 1.62121641e-01 -5.73186858e-01  8.42409110e-01]
 [ 6.48486566e-01  1.14637468e-01  0.00000000e+00]
 [ 4.86364925e-01  6.88048341e-08  2.80803037e-01]
 [ 3.24243283e-01 -1.14637330e-01  5.61606073e-01]
 [ 1.62121642e-01 -2.29274729e-01  8.42409110e-01]
 [ 6.48486567e-01  4.58549597e-01  0.00000000e+00]
 [ 4.86364926e-01  3.43912198e-01  2.80803037e-01]
 [ 3.24243285e-01  2.29274799e-01  5.61606073e-01]
 [ 1.62121643e-01  1.14637400e-01  8.42409110e-01]
 [ 6.48486569e-01  8.02461726e-01  0.00000000e+00]
 [ 4.86364927e-01  6.87824327e-01  2.80803037e-01]
 [ 3.24243286e-01  5.73186928e-01  5.61606073e-01]
 [ 1.62121645e-01  4.58549529e-01  8.42409110e-01]
 [ 9.72729847e-01 -3.43911992e-01  0.00000000e+00]
 [ 8.10608206e-01 -4.58549391e-01  2.80803037e-01]
 [ 6.48486564e-01 -5.73186790e-01  5.61606073e-01]
 [ 4.86364923e-01 -6.87824188e-01  8.42409110e-01]
 [ 9.72729848e-01  1.36835140e-07  0.00000000e+00]
 [ 8.10608207e-01 -1.14637262e-01  2.80803037e-01]
 [ 6.48486566e-01 -2.29274661e-01  5.61606073e-01]
 [ 4.86364924e-01 -3.43912059e-01  8.42409110e-01]
 [ 9.72729849e-01  3.43912266e-01  0.00000000e+00]
 [ 8.10608208e-01  2.29274867e-01  2.80803037e-01]
 [ 6.48486567e-01  1.14637468e-01  5.61606073e-01]
 [ 4.86364926e-01  6.95793620e-08  8.42409110e-01]
 [ 9.72729851e-01  6.87824395e-01  0.00000000e+00]
 [ 8.10608210e-01  5.73186996e-01  2.80803037e-01]
 [ 6.48486568e-01  4.58549597e-01  5.61606073e-01]
 [ 4.86364927e-01  3.43912199e-01  8.42409110e-01]]
Overwritten attributes  c0 tol kmesh  of <class 'fft_isdf.InterpolativeSeparableDensityFitting'>

WARN: ke_cutoff/mesh (40 / [17 17 17]) is not enough for FFTDF to get integral accuracy 1e-10.
Coulomb integral error is ~ 1.4e+02 Eh.
Recommended ke_cutoff/mesh are 1368.68 / [95 95 95].

kmesh = [4 4 4]
Input parent grid mesh = [12, 12, 12], ke_cutoff =  56.32
Final parent grid size = [13 11 13]

Selecting interpolation points
nkpts = 64, nao = 39, c0 =  40.00
Parent grid mesh = [13 11 13], grid size = 1859

WARN: The parent grid might be too coarse.

    CPU time for select interpolation points    272.95 sec, wall time      4.35 sec
Pivoted Cholesky rank = 1859, nip = 1560, estimated error = 2.32e-04
Number of interpolation points = 1560, effective CISDF =  40.00
    CPU time for building left-hand side     55.60 sec, wall time      1.90 sec

kpt = 64, ngrid = 4913, nao = 39
ngrid = 4913, blksize = 30586, nip = 1560
required disk space = 7 GB
finished creating fswp: /central/scratch/yangjunjie/work/nio-prim/gth-dzvp-molopt-sr/fftisdf-yang-40-40/4-4-4/47048198/ffu19zgv
blksize = 30586, memory for aoR_loop = 48859 MB
finished aoR_loop[       0:    4913]
    CPU time for building right-hand side    132.47 sec, wall time      9.04 sec
w[  0], rank =  313 / 1560
    CPU time for w[  0]    339.43 sec, wall time      5.42 sec
w[  1], rank =  313 / 1560
    CPU time for w[  1]    517.71 sec, wall time      8.44 sec
w[  2], rank =  313 / 1560
    CPU time for w[  2]    353.79 sec, wall time      5.57 sec
w[  3], rank =  313 / 1560
    CPU time for w[  3]    365.18 sec, wall time      5.77 sec
w[  4], rank =  313 / 1560
    CPU time for w[  4]    338.63 sec, wall time      5.35 sec
w[  5], rank =  313 / 1560
    CPU time for w[  5]    346.48 sec, wall time      5.47 sec
w[  6], rank =  313 / 1560
    CPU time for w[  6]    349.35 sec, wall time      5.53 sec
w[  7], rank =  313 / 1560
    CPU time for w[  7]    334.96 sec, wall time      5.39 sec
w[  8], rank =  313 / 1560
    CPU time for w[  8]    346.78 sec, wall time      5.47 sec
w[  9], rank =  313 / 1560
    CPU time for w[  9]    326.76 sec, wall time      5.17 sec
w[ 10], rank =  313 / 1560
    CPU time for w[ 10]    370.08 sec, wall time      5.89 sec
w[ 11], rank =  313 / 1560
    CPU time for w[ 11]    337.38 sec, wall time      5.34 sec
w[ 12], rank =  313 / 1560
    CPU time for w[ 12]    352.53 sec, wall time      5.55 sec
w[ 13], rank =  313 / 1560
    CPU time for w[ 13]    351.44 sec, wall time      5.55 sec
w[ 14], rank =  313 / 1560
    CPU time for w[ 14]    343.18 sec, wall time      5.41 sec
w[ 15], rank =  313 / 1560
    CPU time for w[ 15]    345.66 sec, wall time      5.56 sec
w[ 16], rank =  313 / 1560
    CPU time for w[ 16]    340.11 sec, wall time      5.37 sec
w[ 17], rank =  313 / 1560
    CPU time for w[ 17]    333.76 sec, wall time      5.28 sec
w[ 18], rank =  313 / 1560
    CPU time for w[ 18]    335.25 sec, wall time      5.32 sec
w[ 19], rank =  313 / 1560
    CPU time for w[ 19]    326.25 sec, wall time      5.15 sec
w[ 20], rank =  313 / 1560
    CPU time for w[ 20]    340.65 sec, wall time      5.38 sec
w[ 21], rank =  313 / 1560
    CPU time for w[ 21]    488.58 sec, wall time      7.76 sec
w[ 22], rank =  313 / 1560
    CPU time for w[ 22]    343.94 sec, wall time      5.44 sec
w[ 23], rank =  313 / 1560
    CPU time for w[ 23]    321.81 sec, wall time      5.10 sec
w[ 24], rank =  313 / 1560
    CPU time for w[ 24]    346.98 sec, wall time      5.55 sec
w[ 25], rank =  313 / 1560
    CPU time for w[ 25]    352.18 sec, wall time      5.58 sec
w[ 26], rank =  313 / 1560
    CPU time for w[ 26]    413.51 sec, wall time      6.54 sec
w[ 27], rank =  313 / 1560
    CPU time for w[ 27]    341.72 sec, wall time      5.40 sec
w[ 28], rank =  313 / 1560
    CPU time for w[ 28]    330.34 sec, wall time      5.22 sec
w[ 29], rank =  313 / 1560
    CPU time for w[ 29]    330.06 sec, wall time      5.22 sec
w[ 30], rank =  313 / 1560
    CPU time for w[ 30]    317.36 sec, wall time      5.02 sec
w[ 31], rank =  313 / 1560
    CPU time for w[ 31]    331.34 sec, wall time      5.25 sec
w[ 32], rank =  313 / 1560
    CPU time for w[ 32]    337.85 sec, wall time      5.34 sec
w[ 33], rank =  313 / 1560
    CPU time for w[ 33]    360.70 sec, wall time      5.70 sec
w[ 34], rank =  313 / 1560
    CPU time for w[ 34]    341.03 sec, wall time      5.39 sec
w[ 35], rank =  313 / 1560
    CPU time for w[ 35]    349.30 sec, wall time      5.51 sec
w[ 36], rank =  313 / 1560
    CPU time for w[ 36]    369.20 sec, wall time      5.83 sec
w[ 37], rank =  313 / 1560
    CPU time for w[ 37]    348.30 sec, wall time      5.49 sec
w[ 38], rank =  313 / 1560
    CPU time for w[ 38]    333.87 sec, wall time      5.37 sec
w[ 39], rank =  313 / 1560
    CPU time for w[ 39]    797.63 sec, wall time     13.12 sec
w[ 40], rank =  313 / 1560
    CPU time for w[ 40]    342.66 sec, wall time      5.41 sec
w[ 41], rank =  313 / 1560
    CPU time for w[ 41]    338.50 sec, wall time      5.35 sec
w[ 42], rank =  313 / 1560
    CPU time for w[ 42]    331.95 sec, wall time      5.25 sec
w[ 43], rank =  313 / 1560
    CPU time for w[ 43]    302.72 sec, wall time      4.80 sec
w[ 44], rank =  313 / 1560
    CPU time for w[ 44]    383.90 sec, wall time      6.13 sec
w[ 45], rank =  313 / 1560
    CPU time for w[ 45]    317.71 sec, wall time      5.05 sec
w[ 46], rank =  313 / 1560
    CPU time for w[ 46]    326.57 sec, wall time      5.17 sec
w[ 47], rank =  313 / 1560
    CPU time for w[ 47]    343.36 sec, wall time      5.42 sec
w[ 48], rank =  313 / 1560
    CPU time for w[ 48]    321.19 sec, wall time      5.06 sec
w[ 49], rank =  313 / 1560
    CPU time for w[ 49]    464.98 sec, wall time      7.45 sec
w[ 50], rank =  313 / 1560
    CPU time for w[ 50]    327.89 sec, wall time      5.29 sec
w[ 51], rank =  313 / 1560
    CPU time for w[ 51]    324.64 sec, wall time      5.14 sec
w[ 52], rank =  313 / 1560
    CPU time for w[ 52]    339.39 sec, wall time      5.36 sec
w[ 53], rank =  313 / 1560
    CPU time for w[ 53]    333.58 sec, wall time      5.28 sec
w[ 54], rank =  313 / 1560
    CPU time for w[ 54]    333.25 sec, wall time      5.27 sec
w[ 55], rank =  313 / 1560
    CPU time for w[ 55]    378.90 sec, wall time      5.99 sec
w[ 56], rank =  313 / 1560
    CPU time for w[ 56]    346.76 sec, wall time      5.48 sec
w[ 57], rank =  313 / 1560
    CPU time for w[ 57]    355.28 sec, wall time      5.61 sec
w[ 58], rank =  313 / 1560
    CPU time for w[ 58]    427.97 sec, wall time      6.88 sec
w[ 59], rank =  313 / 1560
    CPU time for w[ 59]    326.65 sec, wall time      5.17 sec
w[ 60], rank =  313 / 1560
    CPU time for w[ 60]    326.75 sec, wall time      5.17 sec
w[ 61], rank =  313 / 1560
    CPU time for w[ 61]    448.01 sec, wall time      7.09 sec
w[ 62], rank =  313 / 1560
    CPU time for w[ 62]    347.80 sec, wall time      5.50 sec
w[ 63], rank =  313 / 1560
    CPU time for w[ 63]    338.11 sec, wall time      5.35 sec
Saving FFTISDF results to /central/scratch/yangjunjie//work/nio-prim/gth-dzvp-molopt-sr/fftisdf-yang-40-40/4-4-4//47048198/tmp.chk
    CPU time for building ISDF  23457.15 sec, wall time    381.65 sec
Traceback (most recent call last):
  File "/central/home/junjiey/work/fftisdf-benchmark/work/nio-prim/gth-dzvp-molopt-sr/fftisdf-yang-40-40/4-4-4/main.py", line 46, in <module>
    main(args)
  File "/central/home/junjiey/work/fftisdf-benchmark/work/nio-prim/gth-dzvp-molopt-sr/fftisdf-yang-40-40/4-4-4/main.py", line 33, in main
    get_jk_time(cell, kmesh, df_obj=df_obj, tmp=df_obj._isdf)
  File "/home/junjiey/work/fftisdf-benchmark/src/utils.py", line 90, in get_jk_time
    dump("vjk.chk", "vj", vj1)
  File "/home/junjiey/anaconda3/envs/fftisdf/lib/python3.12/site-packages/pyscf/lib/chkfile.py", line 138, in dump
    save_as_group(key, value, fh5)
  File "/home/junjiey/anaconda3/envs/fftisdf/lib/python3.12/site-packages/pyscf/lib/chkfile.py", line 120, in save_as_group
    root[key] = value
    ~~~~^^^^^
  File "/home/junjiey/anaconda3/envs/fftisdf/lib/python3.12/site-packages/h5py/_hl/group.py", line 483, in __setitem__
    ds = self.create_dataset(None, data=obj)
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/junjiey/anaconda3/envs/fftisdf/lib/python3.12/site-packages/h5py/_hl/group.py", line 183, in create_dataset
    dsid = dataset.make_new_dset(group, shape, dtype, data, name, **kwds)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/junjiey/anaconda3/envs/fftisdf/lib/python3.12/site-packages/h5py/_hl/dataset.py", line 168, in make_new_dset
    dset_id.write(h5s.ALL, h5s.ALL, data)
  File "h5py/_objects.pyx", line 54, in h5py._objects.with_phil.wrapper
  File "h5py/_objects.pyx", line 55, in h5py._objects.with_phil.wrapper
  File "h5py/h5d.pyx", line 281, in h5py.h5d.DatasetID.write
  File "h5py/_proxy.pyx", line 115, in h5py._proxy.dset_rw
OSError: [Errno 122] Can't write data (file write failed: time = Thu Jan 30 00:41:29 2025
, filename = 'vjk.chk', file descriptor = 7, errno = 122, error message = 'Disk quota exceeded', buf = 0x55f9b131d610, total write size = 1557504, bytes this sub-write = 1557504, bytes actually written = 18446744073709551615, offset = 0)

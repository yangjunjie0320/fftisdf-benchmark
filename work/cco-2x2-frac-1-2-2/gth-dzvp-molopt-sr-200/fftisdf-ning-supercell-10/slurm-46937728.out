OMP_NUM_THREADS = 64
MKL_NUM_THREADS = 1
PYSCF_MAX_MEMORY = 491520
TMPDIR = /central/scratch/yangjunjie//fftisdf-ning-supercell-10-cco-2x2-frac-1-2-2-gth-dzvp-molopt-sr/46937728/
PYSCF_TMPDIR = /central/scratch/yangjunjie//fftisdf-ning-supercell-10-cco-2x2-frac-1-2-2-gth-dzvp-molopt-sr/46937728/

/home/junjiey/anaconda3/envs/fftisdf/bin/python
2.7.0
1.14.1
1.26.4
WARNING!
  Very diffused basis functions are found in the basis set. They may lead to severe
  linear dependence and numerical instability.  You can set  cell.exp_to_discard=0.1
  to remove the diffused Gaussians whose exponents are less than 0.1.

WARNING!
  Very diffused basis functions are found in the basis set. They may lead to severe
  linear dependence and numerical instability.  You can set  cell.exp_to_discard=0.1
  to remove the diffused Gaussians whose exponents are less than 0.1.

LOADING ISDF BACKEND
NUM_THREADS   : 64
USE_NUMPY     : 0
USE_SCIPY     : 1
USE_TORCH     : 0
USE_TORCH_GPU : 0
#INFO: **** input file is /central/home/junjiey/work/fftisdf-benchmark/work/cco-2x2-frac-1-2-2/gth-dzvp-molopt-sr-200/fftisdf-ning-supercell-10/main.py ****
import os, sys
import numpy, scipy
import pyscf

TMPDIR = os.getenv("TMPDIR", None)
DATA_PATH = os.getenv("DATA_PATH", None)
PYSCF_MAX_MEMORY = os.getenv("PYSCF_MAX_MEMORY", 4000)
PYSCF_MAX_MEMORY = int(PYSCF_MAX_MEMORY)

try:
    from pyscf.lib import generate_pickle_methods
    getstate, setstate = generate_pickle_methods(
        excludes=(
            '_isdf_to_save', 
            '_isdf', 
            'buffer_fft',
            'buffer_cpu', 
            'buffer_gpu', 
            'buffer',
            'cell', 
            'prim_cell',
            '_swapfile',
        )
    )   
except ImportError:
    import sys 
    sys.stderr.write("pyscf.lib.generate_pickle_methods is not available, ISDF will not support pickle\n")
    def raise_error(*args, **kwargs):
        raise NotImplementedError("ISDF does not support pickle")
    getstate = setstate = raise_error

from pyscf.isdf import isdf_local
class ISDF_Local(isdf_local.ISDF_Local):
    __getstate__ = getstate
    __setstate__ = setstate

class ISDF(object):
    cell = None
    group = None

    kpts = None
    kmesh = None
    c0 = None
    verbose = 10

    _isdf = None
    _isdf_to_save = None
    
    def __init__(self, cell=None, kpts=None):
        assert kpts is None
        self.cell = cell
        self.kpts = kpts

    def build(self):
        cell = self.cell.copy(deep=True)

        group = self.group
        assert group is not None

        direct = False
        c0 = self.c0
        rela_qr = 1e-3
        aoR_cutoff = 1e-8
        build_V_K_bunchsize = 512
        with_robust_fitting = False

        from pyscf.lib import logger
        from pyscf.lib.logger import perf_counter
        from pyscf.lib.logger import process_clock
        t0 = (process_clock(), perf_counter())
        log = logger.new_logger(cell, 10)
        log.info("ISDF module: %s" % isdf_local.__file__)

        isdf_obj = ISDF_Local(
            cell, limited_memory=True, direct=direct,
            with_robust_fitting=with_robust_fitting,
            build_V_K_bunchsize=build_V_K_bunchsize,
        )

        isdf_obj.verbose = 10
        log.info("c0 = %6.2f" % c0)

        isdf_obj.build(c=c0, rela_cutoff=rela_qr, group=group)

        nip = isdf_obj.naux
        log.info(
            "Number of interpolation points = %d, effective CISDF = %6.2f",
            nip, nip / isdf_obj.nao
        )
        log.timer("ISDF build", *t0)

        import pickle
        with open(self._isdf, "wb") as f:
            pickle.dump(isdf_obj, f)
            log.debug("finished saving to %s", self._isdf)

        isdf_obj._isdf = self._isdf
        isdf_obj._isdf_to_save = self._isdf
        return isdf_obj

def main(args):
    from utils import cell_from_poscar
    path = os.path.join(DATA_PATH, args.cell)
    assert os.path.exists(path), "Cell file not found: %s" % path

    c = cell_from_poscar(path)
    c.basis = args.basis
    c.pseudo = args.pseudo
    c.verbose = 0
    c.unit = 'aa'
    # c.exp_to_discard = 0.1
    # c.exp_to_discard = 0.0
    c.max_memory = PYSCF_MAX_MEMORY
    c.ke_cutoff = args.ke_cutoff
    c.build(dump_input=False)

    kmesh = [int(x) for x in args.kmesh.split("-")]
    kmesh = numpy.array(kmesh)
    kpts = c.get_kpts(kmesh)

    pcell = c.copy(deep=True)

    natm = len(pcell.atom)
    atm = []
    for ia in range(natm):
        s = pcell.atom_symbol(ia)
        x = pcell.atom_coord(ia, unit='A')
        atm.append([s, x])

    from pyscf.lib.parameters import BOHR
    lvx = pcell.lattice_vectors() * BOHR

    from pyscf.isdf.isdf_tools_cell import build_supercell_with_partition
    scell, group = build_supercell_with_partition(
        atm, lvx, spin=0, charge=0, mesh=None, Ls=kmesh,
        partition=None, basis=args.basis,
        pseudo=args.pseudo, ke_cutoff=args.ke_cutoff,
        max_memory=PYSCF_MAX_MEMORY, 
        precision=1e-12, 
        use_particle_mesh_ewald=True,
        verbose=4,
    )

    from utils import get_jk_time
    df_obj = ISDF(scell)
    df_obj.group = group
    df_obj.c0 = args.c0
    df_obj.verbose = 10
    df_obj.kmesh = kmesh
    df_obj._isdf = os.path.join(TMPDIR, "isdf.chk")

    from utils import get_jk_time
    kmesh = None
    get_jk_time(scell, kmesh=kmesh, df_obj=df_obj, tmp=df_obj._isdf)

if __name__ == "__main__":
    import argparse
    parser = argparse.ArgumentParser()
    parser.add_argument("--cell", type=str, default="diamond-prim.vasp")
    parser.add_argument("--kmesh", type=str, default="2-2-2")
    parser.add_argument("--c0", type=float, default=20.0)
    parser.add_argument("--ke_cutoff", type=float, default=40)
    parser.add_argument("--basis", type=str, default="gth-dzvp-molopt-sr")
    parser.add_argument("--pseudo", type=str, default="gth-pade")

    args = parser.parse_args()
    main(args)
#INFO: ******************** input file end ********************


System: uname_result(system='Linux', node='hpc-34-24.cm.cluster', release='5.14.0-362.24.1.el9_3.x86_64', version='#1 SMP PREEMPT_DYNAMIC Thu Feb 15 07:18:13 EST 2024', machine='x86_64')  Threads 64
Python 3.12.3 | packaged by conda-forge | (main, Apr 15 2024, 18:38:13) [GCC 12.3.0]
numpy 1.26.4  scipy 1.14.1  h5py 3.12.1
Date: Thu Jan 23 20:48:22 2025
PySCF version 2.7.0
PySCF path  /home/junjiey/anaconda3/envs/fftisdf/lib/python3.12/site-packages/pyscf

[ENV] PYSCF_TMPDIR /central/scratch/yangjunjie//fftisdf-ning-supercell-10-cco-2x2-frac-1-2-2-gth-dzvp-molopt-sr/46937728/
[ENV] PYSCF_MAX_MEMORY 491520
[ENV] PYSCF_EXT_PATH /home/junjiey/packages/pyscf-forge/pyscf-forge-yangjunjie-non-orth/
[CONFIG] conf_file None
[INPUT] verbose = 4
[INPUT] num. atoms = 64
[INPUT] num. electrons = 528
[INPUT] charge = 0
[INPUT] spin (= nelec alpha-beta = 2S) = 0
[INPUT] symmetry False subgroup None
[INPUT] Mole.unit = angstorm
[INPUT] Symbol           X                Y                Z      unit          X                Y                Z       unit  Magmom
[INPUT]  1 Cu     1.927800000000   1.927800000000   1.590250000000 AA    3.643014022937   3.643014022937   3.005136969590 Bohr   0.0
[INPUT]  2 Cu     5.783400000000   5.783400000000   1.590250000000 AA   10.929042068810  10.929042068810   3.005136969590 Bohr   0.0
[INPUT]  3 Cu     1.927800000000   5.783400000000   1.590250000000 AA    3.643014022937  10.929042068810   3.005136969590 Bohr   0.0
[INPUT]  4 Cu     5.783400000000   1.927800000000   1.590250000000 AA   10.929042068810   3.643014022937   3.005136969590 Bohr   0.0
[INPUT]  5 O      1.927800000000   3.855600000000   1.590250000000 AA    3.643014022937   7.286028045873   3.005136969590 Bohr   0.0
[INPUT]  6 O      3.855600000000   5.783400000000   1.590250000000 AA    7.286028045873  10.929042068810   3.005136969590 Bohr   0.0
[INPUT]  7 O      5.783400000000   3.855600000000   1.590250000000 AA   10.929042068810   7.286028045873   3.005136969590 Bohr   0.0
[INPUT]  8 O      3.855600000000   1.927800000000   1.590250000000 AA    7.286028045873   3.643014022937   3.005136969590 Bohr   0.0
[INPUT]  9 O      0.000000000000   1.927800000000   1.590250000000 AA    0.000000000000   3.643014022937   3.005136969590 Bohr   0.0
[INPUT] 10 O      1.927800000000   7.711200000000   1.590250000000 AA    3.643014022937  14.572056091746   3.005136969590 Bohr   0.0
[INPUT] 11 O      7.711200000000   5.783400000000   1.590250000000 AA   14.572056091746  10.929042068810   3.005136969590 Bohr   0.0
[INPUT] 12 O      5.783400000000   0.000000000000   1.590250000000 AA   10.929042068810   0.000000000000   3.005136969590 Bohr   0.0
[INPUT] 13 Ca     0.000000000000   0.000000000000   0.000000000000 AA    0.000000000000   0.000000000000   0.000000000000 Bohr   0.0
[INPUT] 14 Ca     3.855600000000   3.855600000000   0.000000000000 AA    7.286028045873   7.286028045873   0.000000000000 Bohr   0.0
[INPUT] 15 Ca     7.711200000000   3.855600000000   0.000000000000 AA   14.572056091746   7.286028045873   0.000000000000 Bohr   0.0
[INPUT] 16 Ca     3.855600000000   7.711200000000   0.000000000000 AA    7.286028045873  14.572056091746   0.000000000000 Bohr   0.0
[INPUT] 17 Cu     1.927800000000   1.927800000000   4.770750000000 AA    3.643014022937   3.643014022937   9.015410908769 Bohr   0.0
[INPUT] 18 Cu     5.783400000000   5.783400000000   4.770750000000 AA   10.929042068810  10.929042068810   9.015410908769 Bohr   0.0
[INPUT] 19 Cu     1.927800000000   5.783400000000   4.770750000000 AA    3.643014022937  10.929042068810   9.015410908769 Bohr   0.0
[INPUT] 20 Cu     5.783400000000   1.927800000000   4.770750000000 AA   10.929042068810   3.643014022937   9.015410908769 Bohr   0.0
[INPUT] 21 O      1.927800000000   3.855600000000   4.770750000000 AA    3.643014022937   7.286028045873   9.015410908769 Bohr   0.0
[INPUT] 22 O      3.855600000000   5.783400000000   4.770750000000 AA    7.286028045873  10.929042068810   9.015410908769 Bohr   0.0
[INPUT] 23 O      5.783400000000   3.855600000000   4.770750000000 AA   10.929042068810   7.286028045873   9.015410908769 Bohr   0.0
[INPUT] 24 O      3.855600000000   1.927800000000   4.770750000000 AA    7.286028045873   3.643014022937   9.015410908769 Bohr   0.0
[INPUT] 25 O      0.000000000000   1.927800000000   4.770750000000 AA    0.000000000000   3.643014022937   9.015410908769 Bohr   0.0
[INPUT] 26 O      1.927800000000   7.711200000000   4.770750000000 AA    3.643014022937  14.572056091746   9.015410908769 Bohr   0.0
[INPUT] 27 O      7.711200000000   5.783400000000   4.770750000000 AA   14.572056091746  10.929042068810   9.015410908769 Bohr   0.0
[INPUT] 28 O      5.783400000000   0.000000000000   4.770750000000 AA   10.929042068810   0.000000000000   9.015410908769 Bohr   0.0
[INPUT] 29 Ca     0.000000000000   0.000000000000   3.180500000000 AA    0.000000000000   0.000000000000   6.010273939179 Bohr   0.0
[INPUT] 30 Ca     3.855600000000   3.855600000000   3.180500000000 AA    7.286028045873   7.286028045873   6.010273939179 Bohr   0.0
[INPUT] 31 Ca     7.711200000000   3.855600000000   3.180500000000 AA   14.572056091746   7.286028045873   6.010273939179 Bohr   0.0
[INPUT] 32 Ca     3.855600000000   7.711200000000   3.180500000000 AA    7.286028045873  14.572056091746   6.010273939179 Bohr   0.0
[INPUT] 33 Cu     1.927800000000   9.639000000000   1.590250000000 AA    3.643014022937  18.215070114683   3.005136969590 Bohr   0.0
[INPUT] 34 Cu     5.783400000000  13.494600000000   1.590250000000 AA   10.929042068810  25.501098160556   3.005136969590 Bohr   0.0
[INPUT] 35 Cu     1.927800000000  13.494600000000   1.590250000000 AA    3.643014022937  25.501098160556   3.005136969590 Bohr   0.0
[INPUT] 36 Cu     5.783400000000   9.639000000000   1.590250000000 AA   10.929042068810  18.215070114683   3.005136969590 Bohr   0.0
[INPUT] 37 O      1.927800000000  11.566800000000   1.590250000000 AA    3.643014022937  21.858084137619   3.005136969590 Bohr   0.0
[INPUT] 38 O      3.855600000000  13.494600000000   1.590250000000 AA    7.286028045873  25.501098160556   3.005136969590 Bohr   0.0
[INPUT] 39 O      5.783400000000  11.566800000000   1.590250000000 AA   10.929042068810  21.858084137619   3.005136969590 Bohr   0.0
[INPUT] 40 O      3.855600000000   9.639000000000   1.590250000000 AA    7.286028045873  18.215070114683   3.005136969590 Bohr   0.0
[INPUT] 41 O      0.000000000000   9.639000000000   1.590250000000 AA    0.000000000000  18.215070114683   3.005136969590 Bohr   0.0
[INPUT] 42 O      1.927800000000  15.422400000000   1.590250000000 AA    3.643014022937  29.144112183492   3.005136969590 Bohr   0.0
[INPUT] 43 O      7.711200000000  13.494600000000   1.590250000000 AA   14.572056091746  25.501098160556   3.005136969590 Bohr   0.0
[INPUT] 44 O      5.783400000000   7.711200000000   1.590250000000 AA   10.929042068810  14.572056091746   3.005136969590 Bohr   0.0
[INPUT] 45 Ca     0.000000000000   7.711200000000   0.000000000000 AA    0.000000000000  14.572056091746   0.000000000000 Bohr   0.0
[INPUT] 46 Ca     3.855600000000  11.566800000000   0.000000000000 AA    7.286028045873  21.858084137619   0.000000000000 Bohr   0.0
[INPUT] 47 Ca     7.711200000000  11.566800000000   0.000000000000 AA   14.572056091746  21.858084137619   0.000000000000 Bohr   0.0
[INPUT] 48 Ca     3.855600000000  15.422400000000   0.000000000000 AA    7.286028045873  29.144112183492   0.000000000000 Bohr   0.0
[INPUT] 49 Cu     1.927800000000   9.639000000000   4.770750000000 AA    3.643014022937  18.215070114683   9.015410908769 Bohr   0.0
[INPUT] 50 Cu     5.783400000000  13.494600000000   4.770750000000 AA   10.929042068810  25.501098160556   9.015410908769 Bohr   0.0
[INPUT] 51 Cu     1.927800000000  13.494600000000   4.770750000000 AA    3.643014022937  25.501098160556   9.015410908769 Bohr   0.0
[INPUT] 52 Cu     5.783400000000   9.639000000000   4.770750000000 AA   10.929042068810  18.215070114683   9.015410908769 Bohr   0.0
[INPUT] 53 O      1.927800000000  11.566800000000   4.770750000000 AA    3.643014022937  21.858084137619   9.015410908769 Bohr   0.0
[INPUT] 54 O      3.855600000000  13.494600000000   4.770750000000 AA    7.286028045873  25.501098160556   9.015410908769 Bohr   0.0
[INPUT] 55 O      5.783400000000  11.566800000000   4.770750000000 AA   10.929042068810  21.858084137619   9.015410908769 Bohr   0.0
[INPUT] 56 O      3.855600000000   9.639000000000   4.770750000000 AA    7.286028045873  18.215070114683   9.015410908769 Bohr   0.0
[INPUT] 57 O      0.000000000000   9.639000000000   4.770750000000 AA    0.000000000000  18.215070114683   9.015410908769 Bohr   0.0
[INPUT] 58 O      1.927800000000  15.422400000000   4.770750000000 AA    3.643014022937  29.144112183492   9.015410908769 Bohr   0.0
[INPUT] 59 O      7.711200000000  13.494600000000   4.770750000000 AA   14.572056091746  25.501098160556   9.015410908769 Bohr   0.0
[INPUT] 60 O      5.783400000000   7.711200000000   4.770750000000 AA   10.929042068810  14.572056091746   9.015410908769 Bohr   0.0
[INPUT] 61 Ca     0.000000000000   7.711200000000   3.180500000000 AA    0.000000000000  14.572056091746   6.010273939179 Bohr   0.0
[INPUT] 62 Ca     3.855600000000  11.566800000000   3.180500000000 AA    7.286028045873  21.858084137619   6.010273939179 Bohr   0.0
[INPUT] 63 Ca     7.711200000000  11.566800000000   3.180500000000 AA   14.572056091746  21.858084137619   6.010273939179 Bohr   0.0
[INPUT] 64 Ca     3.855600000000  15.422400000000   3.180500000000 AA    7.286028045873  29.144112183492   6.010273939179 Bohr   0.0

nuclear repulsion = -1465.81203568248
number of shells = 208
number of NR pGTOs = 3840
number of NR cGTOs = 1040
basis = gth-dzvp-molopt-sr
ecp = {}
CPU time:        11.75
lattice vectors  a1 [14.572056092, 0.000000000, 0.000000000]
                 a2 [0.000000000, 29.144112183, 0.000000000]
                 a3 [0.000000000, 0.000000000, 12.020547878]
dimension = 3
low_dim_ft_type = None
Cell volume = 5105
rcut = 37.859655795834115 (nimgs = [3 2 4])
lattice sum = 439 cells
precision = 1e-12
pseudo = gth-pade
ke_cutoff = 200.0
    = [ 95 187  79] mesh (1403435 PWs)
Initial guess from minao.
ISDF module: /home/junjiey/packages/pyscf-forge/pyscf-forge-yangjunjie-non-orth/pyscf/isdf/isdf_local.py
ISDF: mol.ke_cutoff = 200.000000
ISDF: mol.natm      = 64
ISDF: mol.nao       = 1040
c0 =  10.00
       get_partition wall time:     4.291306 CPU time:     4.586308
len of partition[   0] =  21978
len of partition[   1] =  21192
len of partition[   2] =  21192
len of partition[   3] =  21978
len of partition[   4] =  20909
len of partition[   5] =  21384
len of partition[   6] =  20909
len of partition[   7] =  21330
len of partition[   8] =  20556
len of partition[   9] =  21612
len of partition[  10] =  20616
len of partition[  11] =  20836
len of partition[  12] =  24495
len of partition[  13] =  24448
len of partition[  14] =  24499
len of partition[  15] =  24432
len of partition[  16] =  21546
len of partition[  17] =  20768
len of partition[  18] =  20768
len of partition[  19] =  21546
len of partition[  20] =  20725
len of partition[  21] =  21216
len of partition[  22] =  20725
len of partition[  23] =  21138
len of partition[  24] =  20372
len of partition[  25] =  21420
len of partition[  26] =  20455
len of partition[  27] =  20652
len of partition[  28] =  24480
len of partition[  29] =  24508
len of partition[  30] =  24470
len of partition[  31] =  24544
len of partition[  32] =  21192
len of partition[  33] =  21978
len of partition[  34] =  21978
len of partition[  35] =  21192
len of partition[  36] =  20909
len of partition[  37] =  21330
len of partition[  38] =  20909
len of partition[  39] =  21384
len of partition[  40] =  20616
len of partition[  41] =  20836
len of partition[  42] =  20556
len of partition[  43] =  21612
len of partition[  44] =  24528
len of partition[  45] =  24448
len of partition[  46] =  24499
len of partition[  47] =  24484
len of partition[  48] =  20768
len of partition[  49] =  21546
len of partition[  50] =  21546
len of partition[  51] =  20768
len of partition[  52] =  20725
len of partition[  53] =  21138
len of partition[  54] =  20725
len of partition[  55] =  21216
len of partition[  56] =  20455
len of partition[  57] =  20652
len of partition[  58] =  20372
len of partition[  59] =  21420
len of partition[  60] =  24480
len of partition[  61] =  24508
len of partition[  62] =  24470
len of partition[  63] =  24496
WARNING!
  Very diffused basis functions are found in the basis set. They may lead to severe
  linear dependence and numerical instability.  You can set  cell.exp_to_discard=0.1
  to remove the diffused Gaussians whose exponents are less than 0.1.

WARNING!
  Very diffused basis functions are found in the basis set. They may lead to severe
  linear dependence and numerical instability.  You can set  cell.exp_to_discard=0.1
  to remove the diffused Gaussians whose exponents are less than 0.1.

WARNING!
  Very diffused basis functions are found in the basis set. They may lead to severe
  linear dependence and numerical instability.  You can set  cell.exp_to_discard=0.1
  to remove the diffused Gaussians whose exponents are less than 0.1.

WARNING!
  Very diffused basis functions are found in the basis set. They may lead to severe
  linear dependence and numerical instability.  You can set  cell.exp_to_discard=0.1
  to remove the diffused Gaussians whose exponents are less than 0.1.

WARNING!
  Very diffused basis functions are found in the basis set. They may lead to severe
  linear dependence and numerical instability.  You can set  cell.exp_to_discard=0.1
  to remove the diffused Gaussians whose exponents are less than 0.1.

WARNING!
  Very diffused basis functions are found in the basis set. They may lead to severe
  linear dependence and numerical instability.  You can set  cell.exp_to_discard=0.1
  to remove the diffused Gaussians whose exponents are less than 0.1.

WARNING!
  Very diffused basis functions are found in the basis set. They may lead to severe
  linear dependence and numerical instability.  You can set  cell.exp_to_discard=0.1
  to remove the diffused Gaussians whose exponents are less than 0.1.

WARNING!
  Very diffused basis functions are found in the basis set. They may lead to severe
  linear dependence and numerical instability.  You can set  cell.exp_to_discard=0.1
  to remove the diffused Gaussians whose exponents are less than 0.1.

WARNING!
  Very diffused basis functions are found in the basis set. They may lead to severe
  linear dependence and numerical instability.  You can set  cell.exp_to_discard=0.1
  to remove the diffused Gaussians whose exponents are less than 0.1.

WARNING!
  Very diffused basis functions are found in the basis set. They may lead to severe
  linear dependence and numerical instability.  You can set  cell.exp_to_discard=0.1
  to remove the diffused Gaussians whose exponents are less than 0.1.

WARNING!
  Very diffused basis functions are found in the basis set. They may lead to severe
  linear dependence and numerical instability.  You can set  cell.exp_to_discard=0.1
  to remove the diffused Gaussians whose exponents are less than 0.1.

WARNING!
  Very diffused basis functions are found in the basis set. They may lead to severe
  linear dependence and numerical instability.  You can set  cell.exp_to_discard=0.1
  to remove the diffused Gaussians whose exponents are less than 0.1.

WARNING!
  Very diffused basis functions are found in the basis set. They may lead to severe
  linear dependence and numerical instability.  You can set  cell.exp_to_discard=0.1
  to remove the diffused Gaussians whose exponents are less than 0.1.

WARNING!
  Very diffused basis functions are found in the basis set. They may lead to severe
  linear dependence and numerical instability.  You can set  cell.exp_to_discard=0.1
  to remove the diffused Gaussians whose exponents are less than 0.1.

WARNING!
  Very diffused basis functions are found in the basis set. They may lead to severe
  linear dependence and numerical instability.  You can set  cell.exp_to_discard=0.1
  to remove the diffused Gaussians whose exponents are less than 0.1.

WARNING!
  Very diffused basis functions are found in the basis set. They may lead to severe
  linear dependence and numerical instability.  You can set  cell.exp_to_discard=0.1
  to remove the diffused Gaussians whose exponents are less than 0.1.

WARNING!
  Very diffused basis functions are found in the basis set. They may lead to severe
  linear dependence and numerical instability.  You can set  cell.exp_to_discard=0.1
  to remove the diffused Gaussians whose exponents are less than 0.1.

WARNING!
  Very diffused basis functions are found in the basis set. They may lead to severe
  linear dependence and numerical instability.  You can set  cell.exp_to_discard=0.1
  to remove the diffused Gaussians whose exponents are less than 0.1.

WARNING!
  Very diffused basis functions are found in the basis set. They may lead to severe
  linear dependence and numerical instability.  You can set  cell.exp_to_discard=0.1
  to remove the diffused Gaussians whose exponents are less than 0.1.

WARNING!
  Very diffused basis functions are found in the basis set. They may lead to severe
  linear dependence and numerical instability.  You can set  cell.exp_to_discard=0.1
  to remove the diffused Gaussians whose exponents are less than 0.1.

WARNING!
  Very diffused basis functions are found in the basis set. They may lead to severe
  linear dependence and numerical instability.  You can set  cell.exp_to_discard=0.1
  to remove the diffused Gaussians whose exponents are less than 0.1.

WARNING!
  Very diffused basis functions are found in the basis set. They may lead to severe
  linear dependence and numerical instability.  You can set  cell.exp_to_discard=0.1
  to remove the diffused Gaussians whose exponents are less than 0.1.

WARNING!
  Very diffused basis functions are found in the basis set. They may lead to severe
  linear dependence and numerical instability.  You can set  cell.exp_to_discard=0.1
  to remove the diffused Gaussians whose exponents are less than 0.1.

WARNING!
  Very diffused basis functions are found in the basis set. They may lead to severe
  linear dependence and numerical instability.  You can set  cell.exp_to_discard=0.1
  to remove the diffused Gaussians whose exponents are less than 0.1.

WARNING!
  Very diffused basis functions are found in the basis set. They may lead to severe
  linear dependence and numerical instability.  You can set  cell.exp_to_discard=0.1
  to remove the diffused Gaussians whose exponents are less than 0.1.

WARNING!
  Very diffused basis functions are found in the basis set. They may lead to severe
  linear dependence and numerical instability.  You can set  cell.exp_to_discard=0.1
  to remove the diffused Gaussians whose exponents are less than 0.1.

WARNING!
  Very diffused basis functions are found in the basis set. They may lead to severe
  linear dependence and numerical instability.  You can set  cell.exp_to_discard=0.1
  to remove the diffused Gaussians whose exponents are less than 0.1.

WARNING!
  Very diffused basis functions are found in the basis set. They may lead to severe
  linear dependence and numerical instability.  You can set  cell.exp_to_discard=0.1
  to remove the diffused Gaussians whose exponents are less than 0.1.

WARNING!
  Very diffused basis functions are found in the basis set. They may lead to severe
  linear dependence and numerical instability.  You can set  cell.exp_to_discard=0.1
  to remove the diffused Gaussians whose exponents are less than 0.1.

WARNING!
  Very diffused basis functions are found in the basis set. They may lead to severe
  linear dependence and numerical instability.  You can set  cell.exp_to_discard=0.1
  to remove the diffused Gaussians whose exponents are less than 0.1.

WARNING!
  Very diffused basis functions are found in the basis set. They may lead to severe
  linear dependence and numerical instability.  You can set  cell.exp_to_discard=0.1
  to remove the diffused Gaussians whose exponents are less than 0.1.

WARNING!
  Very diffused basis functions are found in the basis set. They may lead to severe
  linear dependence and numerical instability.  You can set  cell.exp_to_discard=0.1
  to remove the diffused Gaussians whose exponents are less than 0.1.

WARNING!
  Very diffused basis functions are found in the basis set. They may lead to severe
  linear dependence and numerical instability.  You can set  cell.exp_to_discard=0.1
  to remove the diffused Gaussians whose exponents are less than 0.1.

WARNING!
  Very diffused basis functions are found in the basis set. They may lead to severe
  linear dependence and numerical instability.  You can set  cell.exp_to_discard=0.1
  to remove the diffused Gaussians whose exponents are less than 0.1.

WARNING!
  Very diffused basis functions are found in the basis set. They may lead to severe
  linear dependence and numerical instability.  You can set  cell.exp_to_discard=0.1
  to remove the diffused Gaussians whose exponents are less than 0.1.

WARNING!
  Very diffused basis functions are found in the basis set. They may lead to severe
  linear dependence and numerical instability.  You can set  cell.exp_to_discard=0.1
  to remove the diffused Gaussians whose exponents are less than 0.1.

WARNING!
  Very diffused basis functions are found in the basis set. They may lead to severe
  linear dependence and numerical instability.  You can set  cell.exp_to_discard=0.1
  to remove the diffused Gaussians whose exponents are less than 0.1.

WARNING!
  Very diffused basis functions are found in the basis set. They may lead to severe
  linear dependence and numerical instability.  You can set  cell.exp_to_discard=0.1
  to remove the diffused Gaussians whose exponents are less than 0.1.

WARNING!
  Very diffused basis functions are found in the basis set. They may lead to severe
  linear dependence and numerical instability.  You can set  cell.exp_to_discard=0.1
  to remove the diffused Gaussians whose exponents are less than 0.1.

WARNING!
  Very diffused basis functions are found in the basis set. They may lead to severe
  linear dependence and numerical instability.  You can set  cell.exp_to_discard=0.1
  to remove the diffused Gaussians whose exponents are less than 0.1.

WARNING!
  Very diffused basis functions are found in the basis set. They may lead to severe
  linear dependence and numerical instability.  You can set  cell.exp_to_discard=0.1
  to remove the diffused Gaussians whose exponents are less than 0.1.

WARNING!
  Very diffused basis functions are found in the basis set. They may lead to severe
  linear dependence and numerical instability.  You can set  cell.exp_to_discard=0.1
  to remove the diffused Gaussians whose exponents are less than 0.1.

WARNING!
  Very diffused basis functions are found in the basis set. They may lead to severe
  linear dependence and numerical instability.  You can set  cell.exp_to_discard=0.1
  to remove the diffused Gaussians whose exponents are less than 0.1.

WARNING!
  Very diffused basis functions are found in the basis set. They may lead to severe
  linear dependence and numerical instability.  You can set  cell.exp_to_discard=0.1
  to remove the diffused Gaussians whose exponents are less than 0.1.

WARNING!
  Very diffused basis functions are found in the basis set. They may lead to severe
  linear dependence and numerical instability.  You can set  cell.exp_to_discard=0.1
  to remove the diffused Gaussians whose exponents are less than 0.1.

WARNING!
  Very diffused basis functions are found in the basis set. They may lead to severe
  linear dependence and numerical instability.  You can set  cell.exp_to_discard=0.1
  to remove the diffused Gaussians whose exponents are less than 0.1.

WARNING!
  Very diffused basis functions are found in the basis set. They may lead to severe
  linear dependence and numerical instability.  You can set  cell.exp_to_discard=0.1
  to remove the diffused Gaussians whose exponents are less than 0.1.

WARNING!
  Very diffused basis functions are found in the basis set. They may lead to severe
  linear dependence and numerical instability.  You can set  cell.exp_to_discard=0.1
  to remove the diffused Gaussians whose exponents are less than 0.1.

WARNING!
  Very diffused basis functions are found in the basis set. They may lead to severe
  linear dependence and numerical instability.  You can set  cell.exp_to_discard=0.1
  to remove the diffused Gaussians whose exponents are less than 0.1.

WARNING!
  Very diffused basis functions are found in the basis set. They may lead to severe
  linear dependence and numerical instability.  You can set  cell.exp_to_discard=0.1
  to remove the diffused Gaussians whose exponents are less than 0.1.

WARNING!
  Very diffused basis functions are found in the basis set. They may lead to severe
  linear dependence and numerical instability.  You can set  cell.exp_to_discard=0.1
  to remove the diffused Gaussians whose exponents are less than 0.1.

WARNING!
  Very diffused basis functions are found in the basis set. They may lead to severe
  linear dependence and numerical instability.  You can set  cell.exp_to_discard=0.1
  to remove the diffused Gaussians whose exponents are less than 0.1.

WARNING!
  Very diffused basis functions are found in the basis set. They may lead to severe
  linear dependence and numerical instability.  You can set  cell.exp_to_discard=0.1
  to remove the diffused Gaussians whose exponents are less than 0.1.

WARNING!
  Very diffused basis functions are found in the basis set. They may lead to severe
  linear dependence and numerical instability.  You can set  cell.exp_to_discard=0.1
  to remove the diffused Gaussians whose exponents are less than 0.1.

WARNING!
  Very diffused basis functions are found in the basis set. They may lead to severe
  linear dependence and numerical instability.  You can set  cell.exp_to_discard=0.1
  to remove the diffused Gaussians whose exponents are less than 0.1.

WARNING!
  Very diffused basis functions are found in the basis set. They may lead to severe
  linear dependence and numerical instability.  You can set  cell.exp_to_discard=0.1
  to remove the diffused Gaussians whose exponents are less than 0.1.

WARNING!
  Very diffused basis functions are found in the basis set. They may lead to severe
  linear dependence and numerical instability.  You can set  cell.exp_to_discard=0.1
  to remove the diffused Gaussians whose exponents are less than 0.1.

WARNING!
  Very diffused basis functions are found in the basis set. They may lead to severe
  linear dependence and numerical instability.  You can set  cell.exp_to_discard=0.1
  to remove the diffused Gaussians whose exponents are less than 0.1.

WARNING!
  Very diffused basis functions are found in the basis set. They may lead to severe
  linear dependence and numerical instability.  You can set  cell.exp_to_discard=0.1
  to remove the diffused Gaussians whose exponents are less than 0.1.

WARNING!
  Very diffused basis functions are found in the basis set. They may lead to severe
  linear dependence and numerical instability.  You can set  cell.exp_to_discard=0.1
  to remove the diffused Gaussians whose exponents are less than 0.1.

WARNING!
  Very diffused basis functions are found in the basis set. They may lead to severe
  linear dependence and numerical instability.  You can set  cell.exp_to_discard=0.1
  to remove the diffused Gaussians whose exponents are less than 0.1.

WARNING!
  Very diffused basis functions are found in the basis set. They may lead to severe
  linear dependence and numerical instability.  You can set  cell.exp_to_discard=0.1
  to remove the diffused Gaussians whose exponents are less than 0.1.

WARNING!
  Very diffused basis functions are found in the basis set. They may lead to severe
  linear dependence and numerical instability.  You can set  cell.exp_to_discard=0.1
  to remove the diffused Gaussians whose exponents are less than 0.1.

WARNING!
  Very diffused basis functions are found in the basis set. They may lead to severe
  linear dependence and numerical instability.  You can set  cell.exp_to_discard=0.1
  to remove the diffused Gaussians whose exponents are less than 0.1.

             get_aoR wall time:    26.732734 CPU time:  1503.330321
In _build_buffer: ISDF Local size of buffer = 4721.945 MB
 ---------- In pyscf.isdf.isdf_local.select_IP_local_atm ----------
select_IP_local_atm: atm_begin =    0, atm_end =   64
select_IP_local_atm: npt_found =  296
select_IP_local_atm: npt_found =  307
select_IP_local_atm: npt_found =  304
select_IP_local_atm: npt_found =  307
select_IP_local_atm: npt_found =  243
select_IP_local_atm: npt_found =  239
select_IP_local_atm: npt_found =  234
select_IP_local_atm: npt_found =  239
select_IP_local_atm: npt_found =  236
select_IP_local_atm: npt_found =  239
select_IP_local_atm: npt_found =  241
select_IP_local_atm: npt_found =  235
select_IP_local_atm: npt_found =  240
select_IP_local_atm: npt_found =  234
select_IP_local_atm: npt_found =  232
select_IP_local_atm: npt_found =  243
select_IP_local_atm: npt_found =  293
select_IP_local_atm: npt_found =  305
select_IP_local_atm: npt_found =  307
select_IP_local_atm: npt_found =  307
select_IP_local_atm: npt_found =  233
select_IP_local_atm: npt_found =  239
select_IP_local_atm: npt_found =  232
select_IP_local_atm: npt_found =  236
select_IP_local_atm: npt_found =  231
select_IP_local_atm: npt_found =  231
select_IP_local_atm: npt_found =  235
select_IP_local_atm: npt_found =  235
select_IP_local_atm: npt_found =  237
select_IP_local_atm: npt_found =  233
select_IP_local_atm: npt_found =  236
select_IP_local_atm: npt_found =  239
select_IP_local_atm: npt_found =  305
select_IP_local_atm: npt_found =  306
select_IP_local_atm: npt_found =  301
select_IP_local_atm: npt_found =  299
select_IP_local_atm: npt_found =  235
select_IP_local_atm: npt_found =  232
select_IP_local_atm: npt_found =  233
select_IP_local_atm: npt_found =  239
select_IP_local_atm: npt_found =  233
select_IP_local_atm: npt_found =  238
select_IP_local_atm: npt_found =  229
select_IP_local_atm: npt_found =  246
select_IP_local_atm: npt_found =  234
select_IP_local_atm: npt_found =  237
select_IP_local_atm: npt_found =  234
select_IP_local_atm: npt_found =  234
select_IP_local_atm: npt_found =  299
select_IP_local_atm: npt_found =  287
select_IP_local_atm: npt_found =  310
select_IP_local_atm: npt_found =  286
select_IP_local_atm: npt_found =  235
select_IP_local_atm: npt_found =  243
select_IP_local_atm: npt_found =  234
select_IP_local_atm: npt_found =  236
select_IP_local_atm: npt_found =  240
select_IP_local_atm: npt_found =  234
select_IP_local_atm: npt_found =  235
select_IP_local_atm: npt_found =  240
select_IP_local_atm: npt_found =  234
select_IP_local_atm: npt_found =  244
select_IP_local_atm: npt_found =  241
select_IP_local_atm: npt_found =  233
select_IP_local_step1 wall time:    21.382456 CPU time:  1358.425027
 build_aoRg_possible wall time:     0.284806 CPU time:     5.099942
select_IP_local_step2 wall time:     0.000174 CPU time:     0.000185
select_IP_local_step3 wall time:     0.004311 CPU time:     0.004297
Memory usage for aoR  :   9534.332 MB
Memory usage for aoRg :    109.916 MB
            build_IP wall time:    21.671747 CPU time:  1363.529451
build_aux_basis_local wall time:    12.051783 CPU time:   697.374429
 ---------- In pyscf.isdf.isdf_local.build_V_W_local ----------
Memory usage for V:      0.000 MB
Memory usage for W:   1993.369 MB

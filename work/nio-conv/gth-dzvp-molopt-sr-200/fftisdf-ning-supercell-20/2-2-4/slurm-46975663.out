OMP_NUM_THREADS = 64
MKL_NUM_THREADS = 1
PYSCF_MAX_MEMORY = 491520
TMPDIR = /central/scratch/yangjunjie///work/nio-conv/gth-dzvp-molopt-sr-200/fftisdf-ning-supercell-20/2-2-4//46975663/
PYSCF_TMPDIR = /central/scratch/yangjunjie///work/nio-conv/gth-dzvp-molopt-sr-200/fftisdf-ning-supercell-20/2-2-4//46975663/

/home/junjiey/anaconda3/envs/fftisdf/bin/python
2.7.0
1.14.1
1.26.4
WARNING!
  Very diffused basis functions are found in the basis set. They may lead to severe
  linear dependence and numerical instability.  You can set  cell.exp_to_discard=0.1
  to remove the diffused Gaussians whose exponents are less than 0.1.

WARNING!
  Very diffused basis functions are found in the basis set. They may lead to severe
  linear dependence and numerical instability.  You can set  cell.exp_to_discard=0.1
  to remove the diffused Gaussians whose exponents are less than 0.1.

LOADING ISDF BACKEND
NUM_THREADS   : 64
USE_NUMPY     : 0
USE_SCIPY     : 1
USE_TORCH     : 0
USE_TORCH_GPU : 0
#INFO: **** input file is /central/home/junjiey/work/fftisdf-benchmark/work/nio-conv/gth-dzvp-molopt-sr-200/fftisdf-ning-supercell-20/2-2-4/main.py ****
import os, sys
import numpy, scipy
import pyscf

TMPDIR = os.getenv("TMPDIR", None)
DATA_PATH = os.getenv("DATA_PATH", None)
PYSCF_MAX_MEMORY = os.getenv("PYSCF_MAX_MEMORY", 4000)
PYSCF_MAX_MEMORY = int(PYSCF_MAX_MEMORY)

try:
    from pyscf.lib import generate_pickle_methods
    getstate, setstate = generate_pickle_methods(
        excludes=(
            '_isdf_to_save', 
            '_isdf', 
            'buffer_fft',
            'buffer_cpu', 
            'buffer_gpu', 
            'buffer',
            'cell', 
            'prim_cell',
            '_swapfile',
        )
    )   
except ImportError:
    import sys 
    sys.stderr.write("pyscf.lib.generate_pickle_methods is not available, ISDF will not support pickle\n")
    def raise_error(*args, **kwargs):
        raise NotImplementedError("ISDF does not support pickle")
    getstate = setstate = raise_error

from pyscf.isdf import isdf_local
class ISDF_Local(isdf_local.ISDF_Local):
    __getstate__ = getstate
    __setstate__ = setstate

class ISDF(object):
    cell = None
    group = None

    kpts = None
    kmesh = None
    c0 = None
    verbose = 10

    _isdf = None
    _isdf_to_save = None
    
    def __init__(self, cell=None, kpts=None):
        assert kpts is None
        self.cell = cell
        self.kpts = kpts

    def build(self):
        cell = self.cell.copy(deep=True)

        group = self.group
        assert group is not None

        direct = False
        c0 = self.c0
        rela_qr = 1e-3
        aoR_cutoff = 1e-8
        build_V_K_bunchsize = 512
        with_robust_fitting = False

        from pyscf.lib import logger
        from pyscf.lib.logger import perf_counter
        from pyscf.lib.logger import process_clock
        t0 = (process_clock(), perf_counter())
        log = logger.new_logger(cell, 10)
        log.info("ISDF module: %s" % isdf_local.__file__)

        isdf_obj = ISDF_Local(
            cell, limited_memory=True, direct=direct,
            with_robust_fitting=with_robust_fitting,
            build_V_K_bunchsize=build_V_K_bunchsize,
        )

        isdf_obj.verbose = 10
        log.info("c0 = %6.2f" % c0)

        isdf_obj.build(c=c0, rela_cutoff=rela_qr, group=group)

        nip = isdf_obj.naux
        log.info(
            "Number of interpolation points = %d, effective CISDF = %6.2f",
            nip, nip / isdf_obj.nao
        )
        log.timer("ISDF build", *t0)

        import pickle
        with open(self._isdf, "wb") as f:
            pickle.dump(isdf_obj, f)
            log.debug("finished saving to %s", self._isdf)

        isdf_obj._isdf = self._isdf
        isdf_obj._isdf_to_save = self._isdf
        return isdf_obj

def main(args):
    from utils import cell_from_poscar
    path = os.path.join(DATA_PATH, args.cell)
    assert os.path.exists(path), "Cell file not found: %s" % path

    c = cell_from_poscar(path)
    c.basis = args.basis
    c.pseudo = args.pseudo
    c.verbose = 0
    c.unit = 'aa'
    # c.exp_to_discard = 0.1
    # c.exp_to_discard = 0.0
    c.max_memory = PYSCF_MAX_MEMORY
    c.ke_cutoff = args.ke_cutoff
    c.build(dump_input=False)

    kmesh = [int(x) for x in args.kmesh.split("-")]
    kmesh = numpy.array(kmesh)
    kpts = c.get_kpts(kmesh)

    pcell = c.copy(deep=True)

    natm = len(pcell.atom)
    atm = []
    for ia in range(natm):
        s = pcell.atom_symbol(ia)
        x = pcell.atom_coord(ia, unit='A')
        atm.append([s, x])

    from pyscf.lib.parameters import BOHR
    lvx = pcell.lattice_vectors() * BOHR

    from pyscf.isdf.isdf_tools_cell import build_supercell_with_partition
    scell, group = build_supercell_with_partition(
        atm, lvx, spin=0, charge=0, mesh=None, Ls=kmesh,
        partition=None, basis=args.basis,
        pseudo=args.pseudo, ke_cutoff=args.ke_cutoff,
        max_memory=PYSCF_MAX_MEMORY, 
        precision=1e-12, 
        use_particle_mesh_ewald=True,
        verbose=4,
    )

    from utils import get_jk_time
    df_obj = ISDF(scell)
    df_obj.group = group
    df_obj.c0 = args.c0
    df_obj.verbose = 10
    df_obj.kmesh = kmesh
    df_obj._isdf = os.path.join(TMPDIR, "isdf.chk")

    from utils import get_jk_time
    kmesh = None
    get_jk_time(scell, kmesh=kmesh, df_obj=df_obj, tmp=df_obj._isdf)

if __name__ == "__main__":
    import argparse
    parser = argparse.ArgumentParser()
    parser.add_argument("--cell", type=str, default="diamond-prim.vasp")
    parser.add_argument("--kmesh", type=str, default="2-2-2")
    parser.add_argument("--c0", type=float, default=20.0)
    parser.add_argument("--ke_cutoff", type=float, default=40)
    parser.add_argument("--basis", type=str, default="gth-dzvp-molopt-sr")
    parser.add_argument("--pseudo", type=str, default="gth-pade")

    args = parser.parse_args()
    main(args)
#INFO: ******************** input file end ********************


System: uname_result(system='Linux', node='hpc-35-18.cm.cluster', release='5.14.0-362.24.1.el9_3.x86_64', version='#1 SMP PREEMPT_DYNAMIC Thu Feb 15 07:18:13 EST 2024', machine='x86_64')  Threads 64
Python 3.12.3 | packaged by conda-forge | (main, Apr 15 2024, 18:38:13) [GCC 12.3.0]
numpy 1.26.4  scipy 1.14.1  h5py 3.12.1
Date: Fri Jan 24 18:47:08 2025
PySCF version 2.7.0
PySCF path  /home/junjiey/anaconda3/envs/fftisdf/lib/python3.12/site-packages/pyscf

[ENV] PYSCF_TMPDIR /central/scratch/yangjunjie///work/nio-conv/gth-dzvp-molopt-sr-200/fftisdf-ning-supercell-20/2-2-4//46975663/
[ENV] PYSCF_MAX_MEMORY 491520
[ENV] PYSCF_EXT_PATH /home/junjiey/packages/pyscf-forge/pyscf-forge-yangjunjie-non-orth/
[CONFIG] conf_file None
[INPUT] verbose = 4
[INPUT] num. atoms = 128
[INPUT] num. electrons = 1536
[INPUT] charge = 0
[INPUT] spin (= nelec alpha-beta = 2S) = 0
[INPUT] symmetry False subgroup None
[INPUT] Mole.unit = angstorm
[INPUT] Symbol           X                Y                Z      unit          X                Y                Z       unit  Magmom
[INPUT]  1 Ni     0.000000000000   0.000000000000   0.000000000000 AA    0.000000000000   0.000000000000   0.000000000000 Bohr   0.0
[INPUT]  2 Ni    -0.000000000000   2.093168793709   2.093168793709 AA   -0.000000000000   3.955515752597   3.955515752597 Bohr   0.0
[INPUT]  3 Ni     2.093168793709   0.000000000000   2.093168793709 AA    3.955515752597   0.000000000000   3.955515752597 Bohr   0.0
[INPUT]  4 Ni     2.093168793709   2.093168793709   0.000000000000 AA    3.955515752597   3.955515752597   0.000000000000 Bohr   0.0
[INPUT]  5 O      2.093168793709   0.000000000000   0.000000000000 AA    3.955515752597   0.000000000000   0.000000000000 Bohr   0.0
[INPUT]  6 O      2.093168793709   2.093168793709   2.093168793709 AA    3.955515752597   3.955515752597   3.955515752597 Bohr   0.0
[INPUT]  7 O      0.000000000000   0.000000000000   2.093168793709 AA    0.000000000000   0.000000000000   3.955515752597 Bohr   0.0
[INPUT]  8 O     -0.000000000000   2.093168793709   0.000000000000 AA   -0.000000000000   3.955515752597   0.000000000000 Bohr   0.0
[INPUT]  9 Ni     0.000000000000   0.000000000000   4.186337587419 AA    0.000000000000   0.000000000000   7.911031505194 Bohr   0.0
[INPUT] 10 Ni    -0.000000000000   2.093168793709   6.279506381128 AA   -0.000000000000   3.955515752597  11.866547257791 Bohr   0.0
[INPUT] 11 Ni     2.093168793709   0.000000000000   6.279506381128 AA    3.955515752597   0.000000000000  11.866547257791 Bohr   0.0
[INPUT] 12 Ni     2.093168793709   2.093168793709   4.186337587419 AA    3.955515752597   3.955515752597   7.911031505194 Bohr   0.0
[INPUT] 13 O      2.093168793709   0.000000000000   4.186337587419 AA    3.955515752597   0.000000000000   7.911031505194 Bohr   0.0
[INPUT] 14 O      2.093168793709   2.093168793709   6.279506381128 AA    3.955515752597   3.955515752597  11.866547257791 Bohr   0.0
[INPUT] 15 O      0.000000000000   0.000000000000   6.279506381128 AA    0.000000000000   0.000000000000  11.866547257791 Bohr   0.0
[INPUT] 16 O     -0.000000000000   2.093168793709   4.186337587419 AA   -0.000000000000   3.955515752597   7.911031505194 Bohr   0.0
[INPUT] 17 Ni     0.000000000000   0.000000000000   8.372675174838 AA    0.000000000000   0.000000000000  15.822063010388 Bohr   0.0
[INPUT] 18 Ni    -0.000000000000   2.093168793709  10.465843968547 AA   -0.000000000000   3.955515752597  19.777578762985 Bohr   0.0
[INPUT] 19 Ni     2.093168793709   0.000000000000  10.465843968547 AA    3.955515752597   0.000000000000  19.777578762985 Bohr   0.0
[INPUT] 20 Ni     2.093168793709   2.093168793709   8.372675174838 AA    3.955515752597   3.955515752597  15.822063010388 Bohr   0.0
[INPUT] 21 O      2.093168793709   0.000000000000   8.372675174838 AA    3.955515752597   0.000000000000  15.822063010388 Bohr   0.0
[INPUT] 22 O      2.093168793709   2.093168793709  10.465843968547 AA    3.955515752597   3.955515752597  19.777578762985 Bohr   0.0
[INPUT] 23 O      0.000000000000   0.000000000000  10.465843968547 AA    0.000000000000   0.000000000000  19.777578762985 Bohr   0.0
[INPUT] 24 O     -0.000000000000   2.093168793709   8.372675174838 AA   -0.000000000000   3.955515752597  15.822063010388 Bohr   0.0
[INPUT] 25 Ni     0.000000000000   0.000000000000  12.559012762256 AA    0.000000000000   0.000000000000  23.733094515582 Bohr   0.0
[INPUT] 26 Ni    -0.000000000000   2.093168793709  14.652181555966 AA   -0.000000000000   3.955515752597  27.688610268179 Bohr   0.0
[INPUT] 27 Ni     2.093168793709   0.000000000000  14.652181555966 AA    3.955515752597   0.000000000000  27.688610268179 Bohr   0.0
[INPUT] 28 Ni     2.093168793709   2.093168793709  12.559012762256 AA    3.955515752597   3.955515752597  23.733094515582 Bohr   0.0
[INPUT] 29 O      2.093168793709   0.000000000000  12.559012762256 AA    3.955515752597   0.000000000000  23.733094515582 Bohr   0.0
[INPUT] 30 O      2.093168793709   2.093168793709  14.652181555966 AA    3.955515752597   3.955515752597  27.688610268179 Bohr   0.0
[INPUT] 31 O      0.000000000000   0.000000000000  14.652181555966 AA    0.000000000000   0.000000000000  27.688610268179 Bohr   0.0
[INPUT] 32 O     -0.000000000000   2.093168793709  12.559012762256 AA   -0.000000000000   3.955515752597  23.733094515582 Bohr   0.0
[INPUT] 33 Ni    -0.000000000000   4.186337587419   0.000000000000 AA   -0.000000000000   7.911031505194   0.000000000000 Bohr   0.0
[INPUT] 34 Ni    -0.000000000000   6.279506381128   2.093168793709 AA   -0.000000000000  11.866547257791   3.955515752597 Bohr   0.0
[INPUT] 35 Ni     2.093168793709   4.186337587419   2.093168793709 AA    3.955515752597   7.911031505194   3.955515752597 Bohr   0.0
[INPUT] 36 Ni     2.093168793709   6.279506381128   0.000000000000 AA    3.955515752597  11.866547257791   0.000000000000 Bohr   0.0
[INPUT] 37 O      2.093168793709   4.186337587419   0.000000000000 AA    3.955515752597   7.911031505194   0.000000000000 Bohr   0.0
[INPUT] 38 O      2.093168793709   6.279506381128   2.093168793709 AA    3.955515752597  11.866547257791   3.955515752597 Bohr   0.0
[INPUT] 39 O     -0.000000000000   4.186337587419   2.093168793709 AA   -0.000000000000   7.911031505194   3.955515752597 Bohr   0.0
[INPUT] 40 O     -0.000000000000   6.279506381128   0.000000000000 AA   -0.000000000000  11.866547257791   0.000000000000 Bohr   0.0
[INPUT] 41 Ni    -0.000000000000   4.186337587419   4.186337587419 AA   -0.000000000000   7.911031505194   7.911031505194 Bohr   0.0
[INPUT] 42 Ni    -0.000000000000   6.279506381128   6.279506381128 AA   -0.000000000000  11.866547257791  11.866547257791 Bohr   0.0
[INPUT] 43 Ni     2.093168793709   4.186337587419   6.279506381128 AA    3.955515752597   7.911031505194  11.866547257791 Bohr   0.0
[INPUT] 44 Ni     2.093168793709   6.279506381128   4.186337587419 AA    3.955515752597  11.866547257791   7.911031505194 Bohr   0.0
[INPUT] 45 O      2.093168793709   4.186337587419   4.186337587419 AA    3.955515752597   7.911031505194   7.911031505194 Bohr   0.0
[INPUT] 46 O      2.093168793709   6.279506381128   6.279506381128 AA    3.955515752597  11.866547257791  11.866547257791 Bohr   0.0
[INPUT] 47 O     -0.000000000000   4.186337587419   6.279506381128 AA   -0.000000000000   7.911031505194  11.866547257791 Bohr   0.0
[INPUT] 48 O     -0.000000000000   6.279506381128   4.186337587419 AA   -0.000000000000  11.866547257791   7.911031505194 Bohr   0.0
[INPUT] 49 Ni    -0.000000000000   4.186337587419   8.372675174838 AA   -0.000000000000   7.911031505194  15.822063010388 Bohr   0.0
[INPUT] 50 Ni    -0.000000000000   6.279506381128  10.465843968547 AA   -0.000000000000  11.866547257791  19.777578762985 Bohr   0.0
[INPUT] 51 Ni     2.093168793709   4.186337587419  10.465843968547 AA    3.955515752597   7.911031505194  19.777578762985 Bohr   0.0
[INPUT] 52 Ni     2.093168793709   6.279506381128   8.372675174838 AA    3.955515752597  11.866547257791  15.822063010388 Bohr   0.0
[INPUT] 53 O      2.093168793709   4.186337587419   8.372675174838 AA    3.955515752597   7.911031505194  15.822063010388 Bohr   0.0
[INPUT] 54 O      2.093168793709   6.279506381128  10.465843968547 AA    3.955515752597  11.866547257791  19.777578762985 Bohr   0.0
[INPUT] 55 O     -0.000000000000   4.186337587419  10.465843968547 AA   -0.000000000000   7.911031505194  19.777578762985 Bohr   0.0
[INPUT] 56 O     -0.000000000000   6.279506381128   8.372675174838 AA   -0.000000000000  11.866547257791  15.822063010388 Bohr   0.0
[INPUT] 57 Ni    -0.000000000000   4.186337587419  12.559012762256 AA   -0.000000000000   7.911031505194  23.733094515582 Bohr   0.0
[INPUT] 58 Ni    -0.000000000000   6.279506381128  14.652181555966 AA   -0.000000000000  11.866547257791  27.688610268179 Bohr   0.0
[INPUT] 59 Ni     2.093168793709   4.186337587419  14.652181555966 AA    3.955515752597   7.911031505194  27.688610268179 Bohr   0.0
[INPUT] 60 Ni     2.093168793709   6.279506381128  12.559012762256 AA    3.955515752597  11.866547257791  23.733094515582 Bohr   0.0
[INPUT] 61 O      2.093168793709   4.186337587419  12.559012762256 AA    3.955515752597   7.911031505194  23.733094515582 Bohr   0.0
[INPUT] 62 O      2.093168793709   6.279506381128  14.652181555966 AA    3.955515752597  11.866547257791  27.688610268179 Bohr   0.0
[INPUT] 63 O     -0.000000000000   4.186337587419  14.652181555966 AA   -0.000000000000   7.911031505194  27.688610268179 Bohr   0.0
[INPUT] 64 O     -0.000000000000   6.279506381128  12.559012762256 AA   -0.000000000000  11.866547257791  23.733094515582 Bohr   0.0
[INPUT] 65 Ni     4.186337587419   0.000000000000   0.000000000000 AA    7.911031505194   0.000000000000   0.000000000000 Bohr   0.0
[INPUT] 66 Ni     4.186337587419   2.093168793709   2.093168793709 AA    7.911031505194   3.955515752597   3.955515752597 Bohr   0.0
[INPUT] 67 Ni     6.279506381128   0.000000000000   2.093168793709 AA   11.866547257791   0.000000000000   3.955515752597 Bohr   0.0
[INPUT] 68 Ni     6.279506381128   2.093168793709   0.000000000000 AA   11.866547257791   3.955515752597   0.000000000000 Bohr   0.0
[INPUT] 69 O      6.279506381128   0.000000000000   0.000000000000 AA   11.866547257791   0.000000000000   0.000000000000 Bohr   0.0
[INPUT] 70 O      6.279506381128   2.093168793709   2.093168793709 AA   11.866547257791   3.955515752597   3.955515752597 Bohr   0.0
[INPUT] 71 O      4.186337587419   0.000000000000   2.093168793709 AA    7.911031505194   0.000000000000   3.955515752597 Bohr   0.0
[INPUT] 72 O      4.186337587419   2.093168793709   0.000000000000 AA    7.911031505194   3.955515752597   0.000000000000 Bohr   0.0
[INPUT] 73 Ni     4.186337587419   0.000000000000   4.186337587419 AA    7.911031505194   0.000000000000   7.911031505194 Bohr   0.0
[INPUT] 74 Ni     4.186337587419   2.093168793709   6.279506381128 AA    7.911031505194   3.955515752597  11.866547257791 Bohr   0.0
[INPUT] 75 Ni     6.279506381128   0.000000000000   6.279506381128 AA   11.866547257791   0.000000000000  11.866547257791 Bohr   0.0
[INPUT] 76 Ni     6.279506381128   2.093168793709   4.186337587419 AA   11.866547257791   3.955515752597   7.911031505194 Bohr   0.0
[INPUT] 77 O      6.279506381128   0.000000000000   4.186337587419 AA   11.866547257791   0.000000000000   7.911031505194 Bohr   0.0
[INPUT] 78 O      6.279506381128   2.093168793709   6.279506381128 AA   11.866547257791   3.955515752597  11.866547257791 Bohr   0.0
[INPUT] 79 O      4.186337587419   0.000000000000   6.279506381128 AA    7.911031505194   0.000000000000  11.866547257791 Bohr   0.0
[INPUT] 80 O      4.186337587419   2.093168793709   4.186337587419 AA    7.911031505194   3.955515752597   7.911031505194 Bohr   0.0
[INPUT] 81 Ni     4.186337587419   0.000000000000   8.372675174838 AA    7.911031505194   0.000000000000  15.822063010388 Bohr   0.0
[INPUT] 82 Ni     4.186337587419   2.093168793709  10.465843968547 AA    7.911031505194   3.955515752597  19.777578762985 Bohr   0.0
[INPUT] 83 Ni     6.279506381128   0.000000000000  10.465843968547 AA   11.866547257791   0.000000000000  19.777578762985 Bohr   0.0
[INPUT] 84 Ni     6.279506381128   2.093168793709   8.372675174838 AA   11.866547257791   3.955515752597  15.822063010388 Bohr   0.0
[INPUT] 85 O      6.279506381128   0.000000000000   8.372675174838 AA   11.866547257791   0.000000000000  15.822063010388 Bohr   0.0
[INPUT] 86 O      6.279506381128   2.093168793709  10.465843968547 AA   11.866547257791   3.955515752597  19.777578762985 Bohr   0.0
[INPUT] 87 O      4.186337587419   0.000000000000  10.465843968547 AA    7.911031505194   0.000000000000  19.777578762985 Bohr   0.0
[INPUT] 88 O      4.186337587419   2.093168793709   8.372675174838 AA    7.911031505194   3.955515752597  15.822063010388 Bohr   0.0
[INPUT] 89 Ni     4.186337587419   0.000000000000  12.559012762256 AA    7.911031505194   0.000000000000  23.733094515582 Bohr   0.0
[INPUT] 90 Ni     4.186337587419   2.093168793709  14.652181555966 AA    7.911031505194   3.955515752597  27.688610268179 Bohr   0.0
[INPUT] 91 Ni     6.279506381128   0.000000000000  14.652181555966 AA   11.866547257791   0.000000000000  27.688610268179 Bohr   0.0
[INPUT] 92 Ni     6.279506381128   2.093168793709  12.559012762256 AA   11.866547257791   3.955515752597  23.733094515582 Bohr   0.0
[INPUT] 93 O      6.279506381128   0.000000000000  12.559012762256 AA   11.866547257791   0.000000000000  23.733094515582 Bohr   0.0
[INPUT] 94 O      6.279506381128   2.093168793709  14.652181555966 AA   11.866547257791   3.955515752597  27.688610268179 Bohr   0.0
[INPUT] 95 O      4.186337587419   0.000000000000  14.652181555966 AA    7.911031505194   0.000000000000  27.688610268179 Bohr   0.0
[INPUT] 96 O      4.186337587419   2.093168793709  12.559012762256 AA    7.911031505194   3.955515752597  23.733094515582 Bohr   0.0
[INPUT] 97 Ni     4.186337587419   4.186337587419   0.000000000000 AA    7.911031505194   7.911031505194   0.000000000000 Bohr   0.0
[INPUT] 98 Ni     4.186337587419   6.279506381128   2.093168793709 AA    7.911031505194  11.866547257791   3.955515752597 Bohr   0.0
[INPUT] 99 Ni     6.279506381128   4.186337587419   2.093168793709 AA   11.866547257791   7.911031505194   3.955515752597 Bohr   0.0
[INPUT]100 Ni     6.279506381128   6.279506381128   0.000000000000 AA   11.866547257791  11.866547257791   0.000000000000 Bohr   0.0
[INPUT]101 O      6.279506381128   4.186337587419   0.000000000000 AA   11.866547257791   7.911031505194   0.000000000000 Bohr   0.0
[INPUT]102 O      6.279506381128   6.279506381128   2.093168793709 AA   11.866547257791  11.866547257791   3.955515752597 Bohr   0.0
[INPUT]103 O      4.186337587419   4.186337587419   2.093168793709 AA    7.911031505194   7.911031505194   3.955515752597 Bohr   0.0
[INPUT]104 O      4.186337587419   6.279506381128   0.000000000000 AA    7.911031505194  11.866547257791   0.000000000000 Bohr   0.0
[INPUT]105 Ni     4.186337587419   4.186337587419   4.186337587419 AA    7.911031505194   7.911031505194   7.911031505194 Bohr   0.0
[INPUT]106 Ni     4.186337587419   6.279506381128   6.279506381128 AA    7.911031505194  11.866547257791  11.866547257791 Bohr   0.0
[INPUT]107 Ni     6.279506381128   4.186337587419   6.279506381128 AA   11.866547257791   7.911031505194  11.866547257791 Bohr   0.0
[INPUT]108 Ni     6.279506381128   6.279506381128   4.186337587419 AA   11.866547257791  11.866547257791   7.911031505194 Bohr   0.0
[INPUT]109 O      6.279506381128   4.186337587419   4.186337587419 AA   11.866547257791   7.911031505194   7.911031505194 Bohr   0.0
[INPUT]110 O      6.279506381128   6.279506381128   6.279506381128 AA   11.866547257791  11.866547257791  11.866547257791 Bohr   0.0
[INPUT]111 O      4.186337587419   4.186337587419   6.279506381128 AA    7.911031505194   7.911031505194  11.866547257791 Bohr   0.0
[INPUT]112 O      4.186337587419   6.279506381128   4.186337587419 AA    7.911031505194  11.866547257791   7.911031505194 Bohr   0.0
[INPUT]113 Ni     4.186337587419   4.186337587419   8.372675174838 AA    7.911031505194   7.911031505194  15.822063010388 Bohr   0.0
[INPUT]114 Ni     4.186337587419   6.279506381128  10.465843968547 AA    7.911031505194  11.866547257791  19.777578762985 Bohr   0.0
[INPUT]115 Ni     6.279506381128   4.186337587419  10.465843968547 AA   11.866547257791   7.911031505194  19.777578762985 Bohr   0.0
[INPUT]116 Ni     6.279506381128   6.279506381128   8.372675174838 AA   11.866547257791  11.866547257791  15.822063010388 Bohr   0.0
[INPUT]117 O      6.279506381128   4.186337587419   8.372675174838 AA   11.866547257791   7.911031505194  15.822063010388 Bohr   0.0
[INPUT]118 O      6.279506381128   6.279506381128  10.465843968547 AA   11.866547257791  11.866547257791  19.777578762985 Bohr   0.0
[INPUT]119 O      4.186337587419   4.186337587419  10.465843968547 AA    7.911031505194   7.911031505194  19.777578762985 Bohr   0.0
[INPUT]120 O      4.186337587419   6.279506381128   8.372675174838 AA    7.911031505194  11.866547257791  15.822063010388 Bohr   0.0
[INPUT]121 Ni     4.186337587419   4.186337587419  12.559012762256 AA    7.911031505194   7.911031505194  23.733094515582 Bohr   0.0
[INPUT]122 Ni     4.186337587419   6.279506381128  14.652181555966 AA    7.911031505194  11.866547257791  27.688610268179 Bohr   0.0
[INPUT]123 Ni     6.279506381128   4.186337587419  14.652181555966 AA   11.866547257791   7.911031505194  27.688610268179 Bohr   0.0
[INPUT]124 Ni     6.279506381128   6.279506381128  12.559012762256 AA   11.866547257791  11.866547257791  23.733094515582 Bohr   0.0
[INPUT]125 O      6.279506381128   4.186337587419  12.559012762256 AA   11.866547257791   7.911031505194  23.733094515582 Bohr   0.0
[INPUT]126 O      6.279506381128   6.279506381128  14.652181555966 AA   11.866547257791  11.866547257791  27.688610268179 Bohr   0.0
[INPUT]127 O      4.186337587419   4.186337587419  14.652181555966 AA    7.911031505194   7.911031505194  27.688610268179 Bohr   0.0
[INPUT]128 O      4.186337587419   6.279506381128  12.559012762256 AA    7.911031505194  11.866547257791  23.733094515582 Bohr   0.0

nuclear repulsion = -7628.56838044656
number of shells = 448
number of NR pGTOs = 9024
number of NR cGTOs = 2496
basis = gth-dzvp-molopt-sr
ecp = {}
CPU time:        12.38
lattice vectors  a1 [15.822063010, 0.000000000, 0.000000000]
                 a2 [-0.000000000, 15.822063010, 0.000000000]
                 a3 [0.000000000, 0.000000000, 31.644126021]
dimension = 3
low_dim_ft_type = None
Cell volume = 7921.72
rcut = 30.246782904051514 (nimgs = [2 2 1])
lattice sum = 213 cells
precision = 1e-12
pseudo = gth-pade
ke_cutoff = 200.0
    = [103 103 203] mesh (2153627 PWs)
Initial guess from minao.
ISDF module: /home/junjiey/packages/pyscf-forge/pyscf-forge-yangjunjie-non-orth/pyscf/isdf/isdf_local.py
ISDF: mol.ke_cutoff = 200.000000
ISDF: mol.natm      = 128
ISDF: mol.nao       = 2496
c0 =  20.00
       get_partition wall time:     6.120271 CPU time:     6.104537
len of partition[   0] =  15625
len of partition[   1] =  16900
len of partition[   2] =  16900
len of partition[   3] =  16900
len of partition[   4] =  16250
len of partition[   5] =  17576
len of partition[   6] =  16250
len of partition[   7] =  16250
len of partition[   8] =  15625
len of partition[   9] =  16250
len of partition[  10] =  16253
len of partition[  11] =  16900
len of partition[  12] =  16250
len of partition[  13] =  16900
len of partition[  14] =  15661
len of partition[  15] =  16250
len of partition[  16] =  16250
len of partition[  17] =  16264
len of partition[  18] =  16250
len of partition[  19] =  17576
len of partition[  20] =  16900
len of partition[  21] =  16900
len of partition[  22] =  15631
len of partition[  23] =  16900
len of partition[  24] =  15634
len of partition[  25] =  16900
len of partition[  26] =  16900
len of partition[  27] =  16900
len of partition[  28] =  16250
len of partition[  29] =  17576
len of partition[  30] =  16250
len of partition[  31] =  16250
len of partition[  32] =  16250
len of partition[  33] =  16900
len of partition[  34] =  17576
len of partition[  35] =  16920
len of partition[  36] =  16900
len of partition[  37] =  17576
len of partition[  38] =  16900
len of partition[  39] =  16250
len of partition[  40] =  16250
len of partition[  41] =  16220
len of partition[  42] =  16906
len of partition[  43] =  16930
len of partition[  44] =  16900
len of partition[  45] =  16865
len of partition[  46] =  16250
len of partition[  47] =  16250
len of partition[  48] =  16900
len of partition[  49] =  16246
len of partition[  50] =  16959
len of partition[  51] =  17581
len of partition[  52] =  17576
len of partition[  53] =  16900
len of partition[  54] =  16262
len of partition[  55] =  16910
len of partition[  56] =  16279
len of partition[  57] =  16900
len of partition[  58] =  17576
len of partition[  59] =  16947
len of partition[  60] =  16795
len of partition[  61] =  17576
len of partition[  62] =  16945
len of partition[  63] =  16268
len of partition[  64] =  16250
len of partition[  65] =  17576
len of partition[  66] =  16900
len of partition[  67] =  16920
len of partition[  68] =  16250
len of partition[  69] =  17576
len of partition[  70] =  16900
len of partition[  71] =  16900
len of partition[  72] =  16070
len of partition[  73] =  16910
len of partition[  74] =  16250
len of partition[  75] =  16900
len of partition[  76] =  16318
len of partition[  77] =  16905
len of partition[  78] =  16273
len of partition[  79] =  16992
len of partition[  80] =  16900
len of partition[  81] =  16933
len of partition[  82] =  16264
len of partition[  83] =  17615
len of partition[  84] =  16900
len of partition[  85] =  16816
len of partition[  86] =  16270
len of partition[  87] =  17576
len of partition[  88] =  16310
len of partition[  89] =  17576
len of partition[  90] =  16900
len of partition[  91] =  16900
len of partition[  92] =  16241
len of partition[  93] =  17576
len of partition[  94] =  16909
len of partition[  95] =  16900
len of partition[  96] =  16900
len of partition[  97] =  17576
len of partition[  98] =  17576
len of partition[  99] =  16900
len of partition[ 100] =  16934
len of partition[ 101] =  17576
len of partition[ 102] =  17576
len of partition[ 103] =  16880
len of partition[ 104] =  16916
len of partition[ 105] =  16905
len of partition[ 106] =  16899
len of partition[ 107] =  16900
len of partition[ 108] =  16900
len of partition[ 109] =  16899
len of partition[ 110] =  16858
len of partition[ 111] =  16900
len of partition[ 112] =  17601
len of partition[ 113] =  16896
len of partition[ 114] =  16901
len of partition[ 115] =  17566
len of partition[ 116] =  17576
len of partition[ 117] =  16898
len of partition[ 118] =  16818
len of partition[ 119] =  17566
len of partition[ 120] =  16900
len of partition[ 121] =  17567
len of partition[ 122] =  17306
len of partition[ 123] =  16657
len of partition[ 124] =  17012
len of partition[ 125] =  17707
len of partition[ 126] =  17646
len of partition[ 127] =  16905
WARNING!
  Very diffused basis functions are found in the basis set. They may lead to severe
  linear dependence and numerical instability.  You can set  cell.exp_to_discard=0.1
  to remove the diffused Gaussians whose exponents are less than 0.1.

WARNING!
  Very diffused basis functions are found in the basis set. They may lead to severe
  linear dependence and numerical instability.  You can set  cell.exp_to_discard=0.1
  to remove the diffused Gaussians whose exponents are less than 0.1.

WARNING!
  Very diffused basis functions are found in the basis set. They may lead to severe
  linear dependence and numerical instability.  You can set  cell.exp_to_discard=0.1
  to remove the diffused Gaussians whose exponents are less than 0.1.

WARNING!
  Very diffused basis functions are found in the basis set. They may lead to severe
  linear dependence and numerical instability.  You can set  cell.exp_to_discard=0.1
  to remove the diffused Gaussians whose exponents are less than 0.1.

WARNING!
  Very diffused basis functions are found in the basis set. They may lead to severe
  linear dependence and numerical instability.  You can set  cell.exp_to_discard=0.1
  to remove the diffused Gaussians whose exponents are less than 0.1.

WARNING!
  Very diffused basis functions are found in the basis set. They may lead to severe
  linear dependence and numerical instability.  You can set  cell.exp_to_discard=0.1
  to remove the diffused Gaussians whose exponents are less than 0.1.

WARNING!
  Very diffused basis functions are found in the basis set. They may lead to severe
  linear dependence and numerical instability.  You can set  cell.exp_to_discard=0.1
  to remove the diffused Gaussians whose exponents are less than 0.1.

WARNING!
  Very diffused basis functions are found in the basis set. They may lead to severe
  linear dependence and numerical instability.  You can set  cell.exp_to_discard=0.1
  to remove the diffused Gaussians whose exponents are less than 0.1.

WARNING!
  Very diffused basis functions are found in the basis set. They may lead to severe
  linear dependence and numerical instability.  You can set  cell.exp_to_discard=0.1
  to remove the diffused Gaussians whose exponents are less than 0.1.

WARNING!
  Very diffused basis functions are found in the basis set. They may lead to severe
  linear dependence and numerical instability.  You can set  cell.exp_to_discard=0.1
  to remove the diffused Gaussians whose exponents are less than 0.1.

WARNING!
  Very diffused basis functions are found in the basis set. They may lead to severe
  linear dependence and numerical instability.  You can set  cell.exp_to_discard=0.1
  to remove the diffused Gaussians whose exponents are less than 0.1.

WARNING!
  Very diffused basis functions are found in the basis set. They may lead to severe
  linear dependence and numerical instability.  You can set  cell.exp_to_discard=0.1
  to remove the diffused Gaussians whose exponents are less than 0.1.

WARNING!
  Very diffused basis functions are found in the basis set. They may lead to severe
  linear dependence and numerical instability.  You can set  cell.exp_to_discard=0.1
  to remove the diffused Gaussians whose exponents are less than 0.1.

WARNING!
  Very diffused basis functions are found in the basis set. They may lead to severe
  linear dependence and numerical instability.  You can set  cell.exp_to_discard=0.1
  to remove the diffused Gaussians whose exponents are less than 0.1.

WARNING!
  Very diffused basis functions are found in the basis set. They may lead to severe
  linear dependence and numerical instability.  You can set  cell.exp_to_discard=0.1
  to remove the diffused Gaussians whose exponents are less than 0.1.

WARNING!
  Very diffused basis functions are found in the basis set. They may lead to severe
  linear dependence and numerical instability.  You can set  cell.exp_to_discard=0.1
  to remove the diffused Gaussians whose exponents are less than 0.1.

WARNING!
  Very diffused basis functions are found in the basis set. They may lead to severe
  linear dependence and numerical instability.  You can set  cell.exp_to_discard=0.1
  to remove the diffused Gaussians whose exponents are less than 0.1.

WARNING!
  Very diffused basis functions are found in the basis set. They may lead to severe
  linear dependence and numerical instability.  You can set  cell.exp_to_discard=0.1
  to remove the diffused Gaussians whose exponents are less than 0.1.

WARNING!
  Very diffused basis functions are found in the basis set. They may lead to severe
  linear dependence and numerical instability.  You can set  cell.exp_to_discard=0.1
  to remove the diffused Gaussians whose exponents are less than 0.1.

WARNING!
  Very diffused basis functions are found in the basis set. They may lead to severe
  linear dependence and numerical instability.  You can set  cell.exp_to_discard=0.1
  to remove the diffused Gaussians whose exponents are less than 0.1.

WARNING!
  Very diffused basis functions are found in the basis set. They may lead to severe
  linear dependence and numerical instability.  You can set  cell.exp_to_discard=0.1
  to remove the diffused Gaussians whose exponents are less than 0.1.

WARNING!
  Very diffused basis functions are found in the basis set. They may lead to severe
  linear dependence and numerical instability.  You can set  cell.exp_to_discard=0.1
  to remove the diffused Gaussians whose exponents are less than 0.1.

WARNING!
  Very diffused basis functions are found in the basis set. They may lead to severe
  linear dependence and numerical instability.  You can set  cell.exp_to_discard=0.1
  to remove the diffused Gaussians whose exponents are less than 0.1.

WARNING!
  Very diffused basis functions are found in the basis set. They may lead to severe
  linear dependence and numerical instability.  You can set  cell.exp_to_discard=0.1
  to remove the diffused Gaussians whose exponents are less than 0.1.

WARNING!
  Very diffused basis functions are found in the basis set. They may lead to severe
  linear dependence and numerical instability.  You can set  cell.exp_to_discard=0.1
  to remove the diffused Gaussians whose exponents are less than 0.1.

WARNING!
  Very diffused basis functions are found in the basis set. They may lead to severe
  linear dependence and numerical instability.  You can set  cell.exp_to_discard=0.1
  to remove the diffused Gaussians whose exponents are less than 0.1.

WARNING!
  Very diffused basis functions are found in the basis set. They may lead to severe
  linear dependence and numerical instability.  You can set  cell.exp_to_discard=0.1
  to remove the diffused Gaussians whose exponents are less than 0.1.

WARNING!
  Very diffused basis functions are found in the basis set. They may lead to severe
  linear dependence and numerical instability.  You can set  cell.exp_to_discard=0.1
  to remove the diffused Gaussians whose exponents are less than 0.1.

WARNING!
  Very diffused basis functions are found in the basis set. They may lead to severe
  linear dependence and numerical instability.  You can set  cell.exp_to_discard=0.1
  to remove the diffused Gaussians whose exponents are less than 0.1.

WARNING!
  Very diffused basis functions are found in the basis set. They may lead to severe
  linear dependence and numerical instability.  You can set  cell.exp_to_discard=0.1
  to remove the diffused Gaussians whose exponents are less than 0.1.

WARNING!
  Very diffused basis functions are found in the basis set. They may lead to severe
  linear dependence and numerical instability.  You can set  cell.exp_to_discard=0.1
  to remove the diffused Gaussians whose exponents are less than 0.1.

WARNING!
  Very diffused basis functions are found in the basis set. They may lead to severe
  linear dependence and numerical instability.  You can set  cell.exp_to_discard=0.1
  to remove the diffused Gaussians whose exponents are less than 0.1.

WARNING!
  Very diffused basis functions are found in the basis set. They may lead to severe
  linear dependence and numerical instability.  You can set  cell.exp_to_discard=0.1
  to remove the diffused Gaussians whose exponents are less than 0.1.

WARNING!
  Very diffused basis functions are found in the basis set. They may lead to severe
  linear dependence and numerical instability.  You can set  cell.exp_to_discard=0.1
  to remove the diffused Gaussians whose exponents are less than 0.1.

WARNING!
  Very diffused basis functions are found in the basis set. They may lead to severe
  linear dependence and numerical instability.  You can set  cell.exp_to_discard=0.1
  to remove the diffused Gaussians whose exponents are less than 0.1.

WARNING!
  Very diffused basis functions are found in the basis set. They may lead to severe
  linear dependence and numerical instability.  You can set  cell.exp_to_discard=0.1
  to remove the diffused Gaussians whose exponents are less than 0.1.

WARNING!
  Very diffused basis functions are found in the basis set. They may lead to severe
  linear dependence and numerical instability.  You can set  cell.exp_to_discard=0.1
  to remove the diffused Gaussians whose exponents are less than 0.1.

WARNING!
  Very diffused basis functions are found in the basis set. They may lead to severe
  linear dependence and numerical instability.  You can set  cell.exp_to_discard=0.1
  to remove the diffused Gaussians whose exponents are less than 0.1.

WARNING!
  Very diffused basis functions are found in the basis set. They may lead to severe
  linear dependence and numerical instability.  You can set  cell.exp_to_discard=0.1
  to remove the diffused Gaussians whose exponents are less than 0.1.

WARNING!
  Very diffused basis functions are found in the basis set. They may lead to severe
  linear dependence and numerical instability.  You can set  cell.exp_to_discard=0.1
  to remove the diffused Gaussians whose exponents are less than 0.1.

WARNING!
  Very diffused basis functions are found in the basis set. They may lead to severe
  linear dependence and numerical instability.  You can set  cell.exp_to_discard=0.1
  to remove the diffused Gaussians whose exponents are less than 0.1.

WARNING!
  Very diffused basis functions are found in the basis set. They may lead to severe
  linear dependence and numerical instability.  You can set  cell.exp_to_discard=0.1
  to remove the diffused Gaussians whose exponents are less than 0.1.

WARNING!
  Very diffused basis functions are found in the basis set. They may lead to severe
  linear dependence and numerical instability.  You can set  cell.exp_to_discard=0.1
  to remove the diffused Gaussians whose exponents are less than 0.1.

WARNING!
  Very diffused basis functions are found in the basis set. They may lead to severe
  linear dependence and numerical instability.  You can set  cell.exp_to_discard=0.1
  to remove the diffused Gaussians whose exponents are less than 0.1.

WARNING!
  Very diffused basis functions are found in the basis set. They may lead to severe
  linear dependence and numerical instability.  You can set  cell.exp_to_discard=0.1
  to remove the diffused Gaussians whose exponents are less than 0.1.

WARNING!
  Very diffused basis functions are found in the basis set. They may lead to severe
  linear dependence and numerical instability.  You can set  cell.exp_to_discard=0.1
  to remove the diffused Gaussians whose exponents are less than 0.1.

WARNING!
  Very diffused basis functions are found in the basis set. They may lead to severe
  linear dependence and numerical instability.  You can set  cell.exp_to_discard=0.1
  to remove the diffused Gaussians whose exponents are less than 0.1.

WARNING!
  Very diffused basis functions are found in the basis set. They may lead to severe
  linear dependence and numerical instability.  You can set  cell.exp_to_discard=0.1
  to remove the diffused Gaussians whose exponents are less than 0.1.

WARNING!
  Very diffused basis functions are found in the basis set. They may lead to severe
  linear dependence and numerical instability.  You can set  cell.exp_to_discard=0.1
  to remove the diffused Gaussians whose exponents are less than 0.1.

WARNING!
  Very diffused basis functions are found in the basis set. They may lead to severe
  linear dependence and numerical instability.  You can set  cell.exp_to_discard=0.1
  to remove the diffused Gaussians whose exponents are less than 0.1.

WARNING!
  Very diffused basis functions are found in the basis set. They may lead to severe
  linear dependence and numerical instability.  You can set  cell.exp_to_discard=0.1
  to remove the diffused Gaussians whose exponents are less than 0.1.

WARNING!
  Very diffused basis functions are found in the basis set. They may lead to severe
  linear dependence and numerical instability.  You can set  cell.exp_to_discard=0.1
  to remove the diffused Gaussians whose exponents are less than 0.1.

WARNING!
  Very diffused basis functions are found in the basis set. They may lead to severe
  linear dependence and numerical instability.  You can set  cell.exp_to_discard=0.1
  to remove the diffused Gaussians whose exponents are less than 0.1.

WARNING!
  Very diffused basis functions are found in the basis set. They may lead to severe
  linear dependence and numerical instability.  You can set  cell.exp_to_discard=0.1
  to remove the diffused Gaussians whose exponents are less than 0.1.

WARNING!
  Very diffused basis functions are found in the basis set. They may lead to severe
  linear dependence and numerical instability.  You can set  cell.exp_to_discard=0.1
  to remove the diffused Gaussians whose exponents are less than 0.1.

WARNING!
  Very diffused basis functions are found in the basis set. They may lead to severe
  linear dependence and numerical instability.  You can set  cell.exp_to_discard=0.1
  to remove the diffused Gaussians whose exponents are less than 0.1.

WARNING!
  Very diffused basis functions are found in the basis set. They may lead to severe
  linear dependence and numerical instability.  You can set  cell.exp_to_discard=0.1
  to remove the diffused Gaussians whose exponents are less than 0.1.

WARNING!
  Very diffused basis functions are found in the basis set. They may lead to severe
  linear dependence and numerical instability.  You can set  cell.exp_to_discard=0.1
  to remove the diffused Gaussians whose exponents are less than 0.1.

WARNING!
  Very diffused basis functions are found in the basis set. They may lead to severe
  linear dependence and numerical instability.  You can set  cell.exp_to_discard=0.1
  to remove the diffused Gaussians whose exponents are less than 0.1.

WARNING!
  Very diffused basis functions are found in the basis set. They may lead to severe
  linear dependence and numerical instability.  You can set  cell.exp_to_discard=0.1
  to remove the diffused Gaussians whose exponents are less than 0.1.

WARNING!
  Very diffused basis functions are found in the basis set. They may lead to severe
  linear dependence and numerical instability.  You can set  cell.exp_to_discard=0.1
  to remove the diffused Gaussians whose exponents are less than 0.1.

WARNING!
  Very diffused basis functions are found in the basis set. They may lead to severe
  linear dependence and numerical instability.  You can set  cell.exp_to_discard=0.1
  to remove the diffused Gaussians whose exponents are less than 0.1.

WARNING!
  Very diffused basis functions are found in the basis set. They may lead to severe
  linear dependence and numerical instability.  You can set  cell.exp_to_discard=0.1
  to remove the diffused Gaussians whose exponents are less than 0.1.

WARNING!
  Very diffused basis functions are found in the basis set. They may lead to severe
  linear dependence and numerical instability.  You can set  cell.exp_to_discard=0.1
  to remove the diffused Gaussians whose exponents are less than 0.1.

WARNING!
  Very diffused basis functions are found in the basis set. They may lead to severe
  linear dependence and numerical instability.  You can set  cell.exp_to_discard=0.1
  to remove the diffused Gaussians whose exponents are less than 0.1.

WARNING!
  Very diffused basis functions are found in the basis set. They may lead to severe
  linear dependence and numerical instability.  You can set  cell.exp_to_discard=0.1
  to remove the diffused Gaussians whose exponents are less than 0.1.

WARNING!
  Very diffused basis functions are found in the basis set. They may lead to severe
  linear dependence and numerical instability.  You can set  cell.exp_to_discard=0.1
  to remove the diffused Gaussians whose exponents are less than 0.1.

WARNING!
  Very diffused basis functions are found in the basis set. They may lead to severe
  linear dependence and numerical instability.  You can set  cell.exp_to_discard=0.1
  to remove the diffused Gaussians whose exponents are less than 0.1.

WARNING!
  Very diffused basis functions are found in the basis set. They may lead to severe
  linear dependence and numerical instability.  You can set  cell.exp_to_discard=0.1
  to remove the diffused Gaussians whose exponents are less than 0.1.

WARNING!
  Very diffused basis functions are found in the basis set. They may lead to severe
  linear dependence and numerical instability.  You can set  cell.exp_to_discard=0.1
  to remove the diffused Gaussians whose exponents are less than 0.1.

WARNING!
  Very diffused basis functions are found in the basis set. They may lead to severe
  linear dependence and numerical instability.  You can set  cell.exp_to_discard=0.1
  to remove the diffused Gaussians whose exponents are less than 0.1.

WARNING!
  Very diffused basis functions are found in the basis set. They may lead to severe
  linear dependence and numerical instability.  You can set  cell.exp_to_discard=0.1
  to remove the diffused Gaussians whose exponents are less than 0.1.

WARNING!
  Very diffused basis functions are found in the basis set. They may lead to severe
  linear dependence and numerical instability.  You can set  cell.exp_to_discard=0.1
  to remove the diffused Gaussians whose exponents are less than 0.1.

WARNING!
  Very diffused basis functions are found in the basis set. They may lead to severe
  linear dependence and numerical instability.  You can set  cell.exp_to_discard=0.1
  to remove the diffused Gaussians whose exponents are less than 0.1.

WARNING!
  Very diffused basis functions are found in the basis set. They may lead to severe
  linear dependence and numerical instability.  You can set  cell.exp_to_discard=0.1
  to remove the diffused Gaussians whose exponents are less than 0.1.

WARNING!
  Very diffused basis functions are found in the basis set. They may lead to severe
  linear dependence and numerical instability.  You can set  cell.exp_to_discard=0.1
  to remove the diffused Gaussians whose exponents are less than 0.1.

WARNING!
  Very diffused basis functions are found in the basis set. They may lead to severe
  linear dependence and numerical instability.  You can set  cell.exp_to_discard=0.1
  to remove the diffused Gaussians whose exponents are less than 0.1.

WARNING!
  Very diffused basis functions are found in the basis set. They may lead to severe
  linear dependence and numerical instability.  You can set  cell.exp_to_discard=0.1
  to remove the diffused Gaussians whose exponents are less than 0.1.

WARNING!
  Very diffused basis functions are found in the basis set. They may lead to severe
  linear dependence and numerical instability.  You can set  cell.exp_to_discard=0.1
  to remove the diffused Gaussians whose exponents are less than 0.1.

WARNING!
  Very diffused basis functions are found in the basis set. They may lead to severe
  linear dependence and numerical instability.  You can set  cell.exp_to_discard=0.1
  to remove the diffused Gaussians whose exponents are less than 0.1.

WARNING!
  Very diffused basis functions are found in the basis set. They may lead to severe
  linear dependence and numerical instability.  You can set  cell.exp_to_discard=0.1
  to remove the diffused Gaussians whose exponents are less than 0.1.

WARNING!
  Very diffused basis functions are found in the basis set. They may lead to severe
  linear dependence and numerical instability.  You can set  cell.exp_to_discard=0.1
  to remove the diffused Gaussians whose exponents are less than 0.1.

WARNING!
  Very diffused basis functions are found in the basis set. They may lead to severe
  linear dependence and numerical instability.  You can set  cell.exp_to_discard=0.1
  to remove the diffused Gaussians whose exponents are less than 0.1.

WARNING!
  Very diffused basis functions are found in the basis set. They may lead to severe
  linear dependence and numerical instability.  You can set  cell.exp_to_discard=0.1
  to remove the diffused Gaussians whose exponents are less than 0.1.

WARNING!
  Very diffused basis functions are found in the basis set. They may lead to severe
  linear dependence and numerical instability.  You can set  cell.exp_to_discard=0.1
  to remove the diffused Gaussians whose exponents are less than 0.1.

WARNING!
  Very diffused basis functions are found in the basis set. They may lead to severe
  linear dependence and numerical instability.  You can set  cell.exp_to_discard=0.1
  to remove the diffused Gaussians whose exponents are less than 0.1.

WARNING!
  Very diffused basis functions are found in the basis set. They may lead to severe
  linear dependence and numerical instability.  You can set  cell.exp_to_discard=0.1
  to remove the diffused Gaussians whose exponents are less than 0.1.

WARNING!
  Very diffused basis functions are found in the basis set. They may lead to severe
  linear dependence and numerical instability.  You can set  cell.exp_to_discard=0.1
  to remove the diffused Gaussians whose exponents are less than 0.1.

WARNING!
  Very diffused basis functions are found in the basis set. They may lead to severe
  linear dependence and numerical instability.  You can set  cell.exp_to_discard=0.1
  to remove the diffused Gaussians whose exponents are less than 0.1.

WARNING!
  Very diffused basis functions are found in the basis set. They may lead to severe
  linear dependence and numerical instability.  You can set  cell.exp_to_discard=0.1
  to remove the diffused Gaussians whose exponents are less than 0.1.

WARNING!
  Very diffused basis functions are found in the basis set. They may lead to severe
  linear dependence and numerical instability.  You can set  cell.exp_to_discard=0.1
  to remove the diffused Gaussians whose exponents are less than 0.1.

WARNING!
  Very diffused basis functions are found in the basis set. They may lead to severe
  linear dependence and numerical instability.  You can set  cell.exp_to_discard=0.1
  to remove the diffused Gaussians whose exponents are less than 0.1.

WARNING!
  Very diffused basis functions are found in the basis set. They may lead to severe
  linear dependence and numerical instability.  You can set  cell.exp_to_discard=0.1
  to remove the diffused Gaussians whose exponents are less than 0.1.

WARNING!
  Very diffused basis functions are found in the basis set. They may lead to severe
  linear dependence and numerical instability.  You can set  cell.exp_to_discard=0.1
  to remove the diffused Gaussians whose exponents are less than 0.1.

WARNING!
  Very diffused basis functions are found in the basis set. They may lead to severe
  linear dependence and numerical instability.  You can set  cell.exp_to_discard=0.1
  to remove the diffused Gaussians whose exponents are less than 0.1.

WARNING!
  Very diffused basis functions are found in the basis set. They may lead to severe
  linear dependence and numerical instability.  You can set  cell.exp_to_discard=0.1
  to remove the diffused Gaussians whose exponents are less than 0.1.

WARNING!
  Very diffused basis functions are found in the basis set. They may lead to severe
  linear dependence and numerical instability.  You can set  cell.exp_to_discard=0.1
  to remove the diffused Gaussians whose exponents are less than 0.1.

WARNING!
  Very diffused basis functions are found in the basis set. They may lead to severe
  linear dependence and numerical instability.  You can set  cell.exp_to_discard=0.1
  to remove the diffused Gaussians whose exponents are less than 0.1.

WARNING!
  Very diffused basis functions are found in the basis set. They may lead to severe
  linear dependence and numerical instability.  You can set  cell.exp_to_discard=0.1
  to remove the diffused Gaussians whose exponents are less than 0.1.

WARNING!
  Very diffused basis functions are found in the basis set. They may lead to severe
  linear dependence and numerical instability.  You can set  cell.exp_to_discard=0.1
  to remove the diffused Gaussians whose exponents are less than 0.1.

WARNING!
  Very diffused basis functions are found in the basis set. They may lead to severe
  linear dependence and numerical instability.  You can set  cell.exp_to_discard=0.1
  to remove the diffused Gaussians whose exponents are less than 0.1.

WARNING!
  Very diffused basis functions are found in the basis set. They may lead to severe
  linear dependence and numerical instability.  You can set  cell.exp_to_discard=0.1
  to remove the diffused Gaussians whose exponents are less than 0.1.

WARNING!
  Very diffused basis functions are found in the basis set. They may lead to severe
  linear dependence and numerical instability.  You can set  cell.exp_to_discard=0.1
  to remove the diffused Gaussians whose exponents are less than 0.1.

WARNING!
  Very diffused basis functions are found in the basis set. They may lead to severe
  linear dependence and numerical instability.  You can set  cell.exp_to_discard=0.1
  to remove the diffused Gaussians whose exponents are less than 0.1.

WARNING!
  Very diffused basis functions are found in the basis set. They may lead to severe
  linear dependence and numerical instability.  You can set  cell.exp_to_discard=0.1
  to remove the diffused Gaussians whose exponents are less than 0.1.

WARNING!
  Very diffused basis functions are found in the basis set. They may lead to severe
  linear dependence and numerical instability.  You can set  cell.exp_to_discard=0.1
  to remove the diffused Gaussians whose exponents are less than 0.1.

WARNING!
  Very diffused basis functions are found in the basis set. They may lead to severe
  linear dependence and numerical instability.  You can set  cell.exp_to_discard=0.1
  to remove the diffused Gaussians whose exponents are less than 0.1.

WARNING!
  Very diffused basis functions are found in the basis set. They may lead to severe
  linear dependence and numerical instability.  You can set  cell.exp_to_discard=0.1
  to remove the diffused Gaussians whose exponents are less than 0.1.

WARNING!
  Very diffused basis functions are found in the basis set. They may lead to severe
  linear dependence and numerical instability.  You can set  cell.exp_to_discard=0.1
  to remove the diffused Gaussians whose exponents are less than 0.1.

WARNING!
  Very diffused basis functions are found in the basis set. They may lead to severe
  linear dependence and numerical instability.  You can set  cell.exp_to_discard=0.1
  to remove the diffused Gaussians whose exponents are less than 0.1.

WARNING!
  Very diffused basis functions are found in the basis set. They may lead to severe
  linear dependence and numerical instability.  You can set  cell.exp_to_discard=0.1
  to remove the diffused Gaussians whose exponents are less than 0.1.

WARNING!
  Very diffused basis functions are found in the basis set. They may lead to severe
  linear dependence and numerical instability.  You can set  cell.exp_to_discard=0.1
  to remove the diffused Gaussians whose exponents are less than 0.1.

WARNING!
  Very diffused basis functions are found in the basis set. They may lead to severe
  linear dependence and numerical instability.  You can set  cell.exp_to_discard=0.1
  to remove the diffused Gaussians whose exponents are less than 0.1.

WARNING!
  Very diffused basis functions are found in the basis set. They may lead to severe
  linear dependence and numerical instability.  You can set  cell.exp_to_discard=0.1
  to remove the diffused Gaussians whose exponents are less than 0.1.

WARNING!
  Very diffused basis functions are found in the basis set. They may lead to severe
  linear dependence and numerical instability.  You can set  cell.exp_to_discard=0.1
  to remove the diffused Gaussians whose exponents are less than 0.1.

WARNING!
  Very diffused basis functions are found in the basis set. They may lead to severe
  linear dependence and numerical instability.  You can set  cell.exp_to_discard=0.1
  to remove the diffused Gaussians whose exponents are less than 0.1.

WARNING!
  Very diffused basis functions are found in the basis set. They may lead to severe
  linear dependence and numerical instability.  You can set  cell.exp_to_discard=0.1
  to remove the diffused Gaussians whose exponents are less than 0.1.

WARNING!
  Very diffused basis functions are found in the basis set. They may lead to severe
  linear dependence and numerical instability.  You can set  cell.exp_to_discard=0.1
  to remove the diffused Gaussians whose exponents are less than 0.1.

WARNING!
  Very diffused basis functions are found in the basis set. They may lead to severe
  linear dependence and numerical instability.  You can set  cell.exp_to_discard=0.1
  to remove the diffused Gaussians whose exponents are less than 0.1.

WARNING!
  Very diffused basis functions are found in the basis set. They may lead to severe
  linear dependence and numerical instability.  You can set  cell.exp_to_discard=0.1
  to remove the diffused Gaussians whose exponents are less than 0.1.

WARNING!
  Very diffused basis functions are found in the basis set. They may lead to severe
  linear dependence and numerical instability.  You can set  cell.exp_to_discard=0.1
  to remove the diffused Gaussians whose exponents are less than 0.1.

WARNING!
  Very diffused basis functions are found in the basis set. They may lead to severe
  linear dependence and numerical instability.  You can set  cell.exp_to_discard=0.1
  to remove the diffused Gaussians whose exponents are less than 0.1.

WARNING!
  Very diffused basis functions are found in the basis set. They may lead to severe
  linear dependence and numerical instability.  You can set  cell.exp_to_discard=0.1
  to remove the diffused Gaussians whose exponents are less than 0.1.

WARNING!
  Very diffused basis functions are found in the basis set. They may lead to severe
  linear dependence and numerical instability.  You can set  cell.exp_to_discard=0.1
  to remove the diffused Gaussians whose exponents are less than 0.1.

WARNING!
  Very diffused basis functions are found in the basis set. They may lead to severe
  linear dependence and numerical instability.  You can set  cell.exp_to_discard=0.1
  to remove the diffused Gaussians whose exponents are less than 0.1.

WARNING!
  Very diffused basis functions are found in the basis set. They may lead to severe
  linear dependence and numerical instability.  You can set  cell.exp_to_discard=0.1
  to remove the diffused Gaussians whose exponents are less than 0.1.

WARNING!
  Very diffused basis functions are found in the basis set. They may lead to severe
  linear dependence and numerical instability.  You can set  cell.exp_to_discard=0.1
  to remove the diffused Gaussians whose exponents are less than 0.1.

WARNING!
  Very diffused basis functions are found in the basis set. They may lead to severe
  linear dependence and numerical instability.  You can set  cell.exp_to_discard=0.1
  to remove the diffused Gaussians whose exponents are less than 0.1.

             get_aoR wall time:    80.839828 CPU time:  3412.961790
In _build_buffer: ISDF Local size of buffer = 8412.605 MB
 ---------- In pyscf.isdf.isdf_local.select_IP_local_atm ----------
select_IP_local_atm: atm_begin =    0, atm_end =  128
select_IP_local_atm: npt_found =  279
select_IP_local_atm: npt_found =  294
select_IP_local_atm: npt_found =  299
select_IP_local_atm: npt_found =  302
select_IP_local_atm: npt_found =  288
select_IP_local_atm: npt_found =  318
select_IP_local_atm: npt_found =  289
select_IP_local_atm: npt_found =  304
select_IP_local_atm: npt_found =  285
select_IP_local_atm: npt_found =  276
select_IP_local_atm: npt_found =  280
select_IP_local_atm: npt_found =  287
select_IP_local_atm: npt_found =  294
select_IP_local_atm: npt_found =  283
select_IP_local_atm: npt_found =  275
select_IP_local_atm: npt_found =  279
select_IP_local_atm: npt_found =  291
select_IP_local_atm: npt_found =  288
select_IP_local_atm: npt_found =  278
select_IP_local_atm: npt_found =  289
select_IP_local_atm: npt_found =  298
select_IP_local_atm: npt_found =  303
select_IP_local_atm: npt_found =  287
select_IP_local_atm: npt_found =  287
select_IP_local_atm: npt_found =  285
select_IP_local_atm: npt_found =  303
select_IP_local_atm: npt_found =  281
select_IP_local_atm: npt_found =  299
select_IP_local_atm: npt_found =  282
select_IP_local_atm: npt_found =  315
select_IP_local_atm: npt_found =  299
select_IP_local_atm: npt_found =  293
select_IP_local_atm: npt_found =  285
select_IP_local_atm: npt_found =  293
select_IP_local_atm: npt_found =  295
select_IP_local_atm: npt_found =  287
select_IP_local_atm: npt_found =  302
select_IP_local_atm: npt_found =  294
select_IP_local_atm: npt_found =  294
select_IP_local_atm: npt_found =  276
select_IP_local_atm: npt_found =  296
select_IP_local_atm: npt_found =  282
select_IP_local_atm: npt_found =  299
select_IP_local_atm: npt_found =  299
select_IP_local_atm: npt_found =  287
select_IP_local_atm: npt_found =  293
select_IP_local_atm: npt_found =  294
select_IP_local_atm: npt_found =  311
select_IP_local_atm: npt_found =  293
select_IP_local_atm: npt_found =  272
select_IP_local_atm: npt_found =  291
select_IP_local_atm: npt_found =  288
select_IP_local_atm: npt_found =  303
select_IP_local_atm: npt_found =  286
select_IP_local_atm: npt_found =  284
select_IP_local_atm: npt_found =  296
select_IP_local_atm: npt_found =  279
select_IP_local_atm: npt_found =  278
select_IP_local_atm: npt_found =  291
select_IP_local_atm: npt_found =  273
select_IP_local_atm: npt_found =  298
select_IP_local_atm: npt_found =  292
select_IP_local_atm: npt_found =  294
select_IP_local_atm: npt_found =  284
select_IP_local_atm: npt_found =  294
select_IP_local_atm: npt_found =  291
select_IP_local_atm: npt_found =  303
select_IP_local_atm: npt_found =  287
select_IP_local_atm: npt_found =  288
select_IP_local_atm: npt_found =  305
select_IP_local_atm: npt_found =  291
select_IP_local_atm: npt_found =  298
select_IP_local_atm: npt_found =  281
select_IP_local_atm: npt_found =  282
select_IP_local_atm: npt_found =  284
select_IP_local_atm: npt_found =  303
select_IP_local_atm: npt_found =  291
select_IP_local_atm: npt_found =  296
select_IP_local_atm: npt_found =  290
select_IP_local_atm: npt_found =  300
select_IP_local_atm: npt_found =  284
select_IP_local_atm: npt_found =  300
select_IP_local_atm: npt_found =  288
select_IP_local_atm: npt_found =  297
select_IP_local_atm: npt_found =  302
select_IP_local_atm: npt_found =  303
select_IP_local_atm: npt_found =  302
select_IP_local_atm: npt_found =  310
select_IP_local_atm: npt_found =  298
select_IP_local_atm: npt_found =  310
select_IP_local_atm: npt_found =  305
select_IP_local_atm: npt_found =  305
select_IP_local_atm: npt_found =  296
select_IP_local_atm: npt_found =  297
select_IP_local_atm: npt_found =  296
select_IP_local_atm: npt_found =  287
select_IP_local_atm: npt_found =  290
select_IP_local_atm: npt_found =  302
select_IP_local_atm: npt_found =  304
select_IP_local_atm: npt_found =  282
select_IP_local_atm: npt_found =  305
select_IP_local_atm: npt_found =  295
select_IP_local_atm: npt_found =  298
select_IP_local_atm: npt_found =  276
select_IP_local_atm: npt_found =  296
select_IP_local_atm: npt_found =  294
select_IP_local_atm: npt_found =  286
select_IP_local_atm: npt_found =  299
select_IP_local_atm: npt_found =  289
select_IP_local_atm: npt_found =  289
select_IP_local_atm: npt_found =  295
select_IP_local_atm: npt_found =  301
select_IP_local_atm: npt_found =  306
select_IP_local_atm: npt_found =  294
select_IP_local_atm: npt_found =  286
select_IP_local_atm: npt_found =  287
select_IP_local_atm: npt_found =  297
select_IP_local_atm: npt_found =  287
select_IP_local_atm: npt_found =  300
select_IP_local_atm: npt_found =  302
select_IP_local_atm: npt_found =  286
select_IP_local_atm: npt_found =  285
select_IP_local_atm: npt_found =  283
select_IP_local_atm: npt_found =  294
select_IP_local_atm: npt_found =  290
select_IP_local_atm: npt_found =  315
select_IP_local_atm: npt_found =  305
select_IP_local_atm: npt_found =  315
select_IP_local_step1 wall time:   132.882515 CPU time:  8396.543195
 build_aoRg_possible wall time:     1.495919 CPU time:     6.980380
select_IP_local_step2 wall time:     0.000181 CPU time:     0.000198
select_IP_local_step3 wall time:     0.011214 CPU time:     0.011197
Memory usage for aoR  :  30106.956 MB
Memory usage for aoRg :    525.899 MB
            build_IP wall time:   134.389830 CPU time:  8403.534970
build_aux_basis_local wall time:    34.428405 CPU time:  1466.002265
 ---------- In pyscf.isdf.isdf_local.build_V_W_local ----------
Memory usage for V:      0.000 MB
Memory usage for W:  10726.547 MB
     build_V_W_local wall time:  5468.097346 CPU time: 15173.308977
Number of interpolation points = 37496, effective CISDF =  15.02
    CPU time for ISDF build  28474.99 sec, wall time   5724.34 sec
/home/junjiey/anaconda3/envs/fftisdf/lib/python3.12/site-packages/pyscf/gto/mole.py:1294: UserWarning: Function mol.dumps drops attribute a because it is not JSON-serializable
  warnings.warn(msg)
/home/junjiey/anaconda3/envs/fftisdf/lib/python3.12/site-packages/pyscf/gto/mole.py:1294: UserWarning: Function mol.dumps drops attribute _mesh because it is not JSON-serializable
  warnings.warn(msg)
finished saving to /central/scratch/yangjunjie///work/nio-conv/gth-dzvp-molopt-sr-200/fftisdf-ning-supercell-20/2-2-4//46975663/isdf.chk
max_memory = 436640 MB (54879 in use)
              J_half wall time:    44.517385 CPU time:  2694.824693
    CPU time for get_jk_dm_local   5111.18 sec, wall time     82.86 sec
max_memory = 436590 MB (54929 in use)
    CPU time for get_jk_dm_local   9800.44 sec, wall time    175.12 sec
